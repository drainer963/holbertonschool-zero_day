function exists(e){return e?!0:0==e||0==e||""==e}function isString(e){return"string"==typeof e}function isFunction(e){return"function"==typeof e}function isArray(e){return e instanceof Array}function isDefined(e){return"undefined"!=typeof e}function valOrEmpty(e){return e?e:""}function valOrDefault(e,n){return exists(e)?e:n}function getQSValue(e,n){var t="&"+n.toLowerCase()+"=",o=e.toLowerCase().indexOf(t);if(-1==o&&(t="?"+n.toLowerCase()+"=",o=e.toLowerCase().indexOf(t),-1==o)){return null}var r=e.indexOf("&",o+1);
return-1==r&&(r=e.length),e.substring(o+t.length,r)}function strEquals(e,n,t){return isString(e)&&isString(n)?t?e.toLowerCase()==n.toLowerCase():e===n:!1}function arrExists(e,n){if(!exists(e)){return!1}for(var t=isArray(n)?n:arguments,o=isArray(n)?0:1,r=o;r<t.length;r++){if(!exists(t[r])||!exists(e[t[r]])){return!1}e=e[t[r]]}return!0}function Derive(e,n){function t(){}var o=n.prototype;t.prototype=e.prototype,n.prototype=new t;for(var r in o){n.prototype[r]=o[r]}}function FormatString(e){for(var n=1;n<arguments.length;n++){e=e.replace(new RegExp("\\{"+(n-1)+"\\}","g"),arguments[n])
}return e}function DoTestDelay(e){return e(),null}function PrintRecoveryCode(e){var n=PrintRecoveryCodeTemplate.format(e.dir.encodeHtml(),e.title.encodeHtml(),e.desc1.encodeHtml(),e.desc2.encodeHtml(),e.rcHeader.encodeHtml(),e.rcValue.encodeHtml(),e.ctHeader.encodeHtml(),e.ctValue.encodeHtml(),e.mnHeader.encodeHtml(),e.mnValue.encodeHtml()),t=window.open();t.document.write(n),t.document.close(),t.print(),t.focus()}function Encrypt(e,n,t,o){var r=[];switch(t.toLowerCase()){case"chgsqsa":if(null==e||null==n){return null
}r=PackageSAData(e,n);break;case"chgpwd":if(null==e||null==o){return null}r=PackageNewAndOldPwd(e,o);break;case"pwd":if(null==e){return null}r=PackagePwdOnly(e);break;case"pin":if(null==e){return null}r=PackagePinOnly(e);break;case"proof":if(null==e&&null==n){return null}r=PackageLoginIntData(null!=e?e:n);break;case"saproof":if(null==n){return null}r=PackageSADataForProof(n);break;case"newpwd":if(null==o){return null}r=PackageNewPwdOnly(o)}if(null==r||"undefined"==typeof r){return r}if("undefined"!=typeof Key&&void 0!==parseRSAKeyFromString){var a=parseRSAKeyFromString(Key)
}var i=RSAEncrypt(r,a,randomNum);return i}function PackageSAData(e,n){var t=[],o=0;t[o++]=1,t[o++]=1,t[o++]=0;var r,a=n.length;for(t[o++]=2*a,r=0;a>r;r++){t[o++]=255&n.charCodeAt(r),t[o++]=(65280&n.charCodeAt(r))>>8}var i=e.length;for(t[o++]=i,r=0;i>r;r++){t[o++]=127&e.charCodeAt(r)}return t}function PackagePwdOnly(e){var n=[],t=0;n[t++]=1,n[t++]=1,n[t++]=0,n[t++]=0;var o,r=e.length;for(n[t++]=r,o=0;r>o;o++){n[t++]=127&e.charCodeAt(o)}return n}function PackagePinOnly(e){var n=[],t=0;n[t++]=1,n[t++]=2,n[t++]=0,n[t++]=0,n[t++]=0;
var o,r=e.length;for(n[t++]=r,o=0;r>o;o++){n[t++]=127&e.charCodeAt(o)}return n}function PackageLoginIntData(e){var n,t=[],o=0;for(n=0;n<e.length;n++){t[o++]=255&e.charCodeAt(n),t[o++]=(65280&e.charCodeAt(n))>>8}return t}function PackageSADataForProof(e){var n,t=[],o=0;for(n=0;n<e.length;n++){t[o++]=127&e.charCodeAt(n),t[o++]=(65280&e.charCodeAt(n))>>8}return t}function PackageNewPwdOnly(e){var n=[],t=0;n[t++]=1,n[t++]=1;var o,r=e.length;for(n[t++]=r,o=0;r>o;o++){n[t++]=127&e.charCodeAt(o)}return n[t++]=0,n[t++]=0,n
}function PackageNewAndOldPwd(e,n){var t=[],o=0;t[o++]=1,t[o++]=1;var r,a=n.length;for(t[o++]=a,r=0;a>r;r++){t[o++]=127&n.charCodeAt(r)}for(t[o++]=0,a=e.length,t[o++]=a,r=0;a>r;r++){t[o++]=127&e.charCodeAt(r)}return t}function mapByteToBase64(e){return e>=0&&26>e?String.fromCharCode(65+e):e>=26&&52>e?String.fromCharCode(97+e-26):e>=52&&62>e?String.fromCharCode(48+e-52):62==e?"+":"/"}function base64Encode(e,n){var t,o="";for(t=n;4>t;t++){e>>=6}for(t=0;n>t;t++){o=mapByteToBase64(63&e)+o,e>>=6}return o}function byteArrayToBase64(e){var n,t,o=e.length,r="";
for(n=o-3;n>=0;n-=3){t=e[n]|e[n+1]<<8|e[n+2]<<16,r+=base64Encode(t,4)}var a=o%3;for(t=0,n+=2;n>=0;n--){t=t<<8|e[n]}return 1==a?r=r+base64Encode(t<<16,2)+"==":2==a&&(r=r+base64Encode(t<<8,3)+"="),r}function parseRSAKeyFromString(e){var n=e.indexOf(";");if(0>n){return null}var t=e.substr(0,n),o=e.substr(n+1),r=t.indexOf("=");if(0>r){return null}var a=t.substr(r+1);if(r=o.indexOf("="),0>r){return null}var i=o.substr(r+1),s=new Object;return s.n=hexStringToMP(i),s.e=parseInt(a,16),s}function RSAEncrypt(e,n){for(var t=[],o=42,r=2*n.n.size-o,a=0;a<e.length;a+=r){if(a+r>=e.length){var i=RSAEncryptBlock(e.slice(a),n,randomNum);
i&&(t=i.concat(t))}else{var i=RSAEncryptBlock(e.slice(a,a+r),n,randomNum);i&&(t=i.concat(t))}}var s=byteArrayToBase64(t);return s}function RSAEncryptBlock(e,n,t){var o=n.n,r=n.e,a=e.length,i=2*o.size,s=42;if(a+s>i){return null}applyPKCSv2Padding(e,i,t),e=e.reverse();var c=byteArrayToMP(e),l=modularExp(c,r,o);l.size=o.size;var u=mpToByteArray(l);return u=u.reverse()}function JSMPnumber(){this.size=1,this.data=[],this.data[0]=0}function duplicateMP(e){var n=new JSMPnumber;return n.size=e.size,n.data=e.data.slice(0),n
}function byteArrayToMP(e){var n=new JSMPnumber,t=0,o=e.length,r=o>>1;for(t=0;r>t;t++){n.data[t]=e[2*t]+(e[1+2*t]<<8)}return o%2&&(n.data[t++]=e[o-1]),n.size=t,n}function mpToByteArray(e){var n=[],t=0,o=e.size;for(t=0;o>t;t++){n[2*t]=255&e.data[t];var r=e.data[t]>>>8;n[2*t+1]=r}return n}function modularExp(e,n,t){for(var o=[],r=0;n>0;){o[r]=1&n,n>>>=1,r++}for(var a=duplicateMP(e),i=r-2;i>=0;i--){a=modularMultiply(a,a,t),1==o[i]&&(a=modularMultiply(a,e,t))}return a}function modularMultiply(e,n,t){var o=multiplyMP(e,n),r=divideMP(o,t);
return r.r}function multiplyMP(e,n){var t=new JSMPnumber;t.size=e.size+n.size;var o,r;for(o=0;o<t.size;o++){t.data[o]=0}var a=e.data,i=n.data,s=t.data;if(e==n){for(o=0;o<e.size;o++){s[2*o]+=a[o]*a[o]}for(o=1;o<e.size;o++){for(r=0;o>r;r++){s[o+r]+=2*a[o]*a[r]}}}else{for(o=0;o<e.size;o++){for(r=0;r<n.size;r++){s[o+r]+=a[o]*i[r]}}}return normalizeJSMP(t),t}function normalizeJSMP(e){var n,t,o,r,a;for(o=e.size,t=0,n=0;o>n;n++){r=e.data[n],r+=t,a=r,t=Math.floor(r/65536),r-=65536*t,e.data[n]=r}}function removeLeadingZeroes(e){for(var n=e.size-1;n>0&&0==e.data[n--];){e.size--
}}function divideMP(e,n){var t=e.size,o=n.size,r=n.data[o-1],a=n.data[o-1]+n.data[o-2]/65536,i=new JSMPnumber;i.size=t-o+1,e.data[t]=0;for(var s=t-1;s>=o-1;s--){var c=s-o+1,l=Math.floor((65536*e.data[s+1]+e.data[s])/a);if(l>0){var u=multiplyAndSubtract(e,l,n,c);for(0>u&&(l--,multiplyAndSubtract(e,l,n,c));u>0&&e.data[s]>=r;){u=multiplyAndSubtract(e,1,n,c),u>0&&l++}}i.data[c]=l}removeLeadingZeroes(e);var d={"q":i,"r":e};return d}function multiplyAndSubtract(e,n,t,o){var r,a=e.data.slice(0),i=0,s=e.data;for(r=0;r<t.size;r++){var c=i+t.data[r]*n;
i=c>>>16,c-=65536*i,c>s[r+o]?(s[r+o]+=65536-c,i++):s[r+o]-=c}return i>0&&(s[r+o]-=i),s[r+o]<0?(e.data=a.slice(0),-1):1}function applyPKCSv2Padding(e,n,t){var o,r=e.length,a=[218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9],i=n-r-40-2,s=[];for(o=0;i>o;o++){s[o]=0}s[i]=1;var c=a.concat(s,e),l=[];for(o=0;20>o;o++){l[o]=Math.floor(256*Math.random())}l=SHA1(l.concat(t));var u=MGF(l,n-21),d=XORarrays(c,u),f=MGF(d,20),p=XORarrays(l,f),v=[];for(v[0]=0,v=v.concat(p,d),o=0;o<v.length;o++){e[o]=v[o]
}}function MGF(e,n){if(n>4096){return null}var t=e.slice(0),o=t.length;t[o++]=0,t[o++]=0,t[o++]=0,t[o]=0;for(var r=0,a=[];a.length<n;){t[o]=r++,a=a.concat(SHA1(t))}return a.slice(0,n)}function XORarrays(e,n){if(e.length!=n.length){return null}for(var t=[],o=e.length,r=0;o>r;r++){t[r]=e[r]^n[r]}return t}function SHA1(e){var n,t=e.slice(0);PadSHA1Input(t);var o={"A":1732584193,"B":4023233417,"C":2562383102,"D":271733878,"E":3285377520};for(n=0;n<t.length;n+=64){SHA1RoundFunction(o,t,n)}var r=[];return wordToBytes(o.A,r,0),wordToBytes(o.B,r,4),wordToBytes(o.C,r,8),wordToBytes(o.D,r,12),wordToBytes(o.E,r,16),r
}function wordToBytes(e,n,t){var o;for(o=3;o>=0;o--){n[t+o]=255&e,e>>>=8}}function PadSHA1Input(e){var n,t=e.length,o=t,r=t%64,a=55>r?56:120;for(e[o++]=128,n=r+1;a>n;n++){e[o++]=0}var i=8*t;for(n=1;8>n;n++){e[o+8-n]=255&i,i>>>=8}}function SHA1RoundFunction(e,n,t){var o,r,a,i=1518500249,s=1859775393,c=2400959708,l=3395469782,u=[],d=e.A,f=e.B,p=e.C,v=e.D,m=e.E;for(r=0,a=t;16>r;r++,a+=4){u[r]=n[a]<<24|n[a+1]<<16|n[a+2]<<8|n[a+3]<<0}for(r=16;80>r;r++){u[r]=rotateLeft(u[r-3]^u[r-8]^u[r-14]^u[r-16],1)}var h;for(o=0;20>o;o++){h=rotateLeft(d,5)+(f&p|~f&v)+m+u[o]+i&4294967295,m=v,v=p,p=rotateLeft(f,30),f=d,d=h
}for(o=20;40>o;o++){h=rotateLeft(d,5)+(f^p^v)+m+u[o]+s&4294967295,m=v,v=p,p=rotateLeft(f,30),f=d,d=h}for(o=40;60>o;o++){h=rotateLeft(d,5)+(f&p|f&v|p&v)+m+u[o]+c&4294967295,m=v,v=p,p=rotateLeft(f,30),f=d,d=h}for(o=60;80>o;o++){h=rotateLeft(d,5)+(f^p^v)+m+u[o]+l&4294967295,m=v,v=p,p=rotateLeft(f,30),f=d,d=h}e.A=e.A+d&4294967295,e.B=e.B+f&4294967295,e.C=e.C+p&4294967295,e.D=e.D+v&4294967295,e.E=e.E+m&4294967295}function rotateLeft(e,n){var t=e>>>32-n,o=(1<<32-n)-1,r=e&o;return r<<n|t}function hexStringToMP(e){var n,t,o=Math.ceil(e.length/4),r=new JSMPnumber;
for(r.size=o,n=0;o>n;n++){t=e.substr(4*n,4),r.data[o-1-n]=parseInt(t,16)}return r}var DOM={"create":function(e,n){var t=null;if(exists(n)&&(n.name||n.type)){if(strEquals(e,"input",!0)&&!strEquals(n.type,"password",!0)){var o=DOM.create("div");o.innerHTML='<input type="'+(exists(n.type)?n.type:"")+'" name="'+(exists(n.name)?n.name:"")+'" />',t=o.childNodes[0],n.type=null,n.name=null}else{try{var r="<"+e;n.type&&(r+=' type="'+n.type+'"'),n.name&&(r+=' name="'+n.name+'"'),r+=">",t=document.createElement(r),n.type=null,n.name=null
}catch(a){t=null}}}return exists(t)||(t=document.createElement(e)),DOM.update(t,n)},"update":function(e,n){if(exists(e)&&exists(n)){for(var t in n){if(strEquals("attr",t,!0)){for(var o in n[t]){exists(n[t][o])&&e.setAttribute(o,""+n[t][o])}}else{exists(n[t])&&(e[t]=n[t])}}}return e},"text":function(e){return document.createTextNode(e)},"clear":function(e){for(;exists(e)&&e.hasChildNodes();){e.removeChild(e.firstChild)}},"isElement":function(e,n){return exists(e)&&e.nodeType==NodeType.Element&&(!isString(n)||strEquals(e.tagName,n,!0))
},"isSelectable":function(e){return DOM.isElement(e,"input")&&e.value.length>0},"visible":function(e,n){return DOM.isElement(e)&&(e.style.visibility=n[1],"none"==n[0]?DOM.hide(e):DOM.display(e)),e},"display":function(e){DOM.isElement(e)&&(e.style.display="block",e.setAttribute("aria-hidden","false"))},"displayInline":function(e){DOM.isElement(e)&&(e.style.display="inline",e.setAttribute("aria-hidden","false"))},"hide":function(e){DOM.isElement(e)&&(e.style.display="none",e.setAttribute("aria-hidden","true"))
},"addClass":function(e,n){for(var t=e.className.split(" "),o=0;o<t.length;o++){if(strEquals(t[o],n,!0)){return}}t.push(n),e.className=t.join(" ")},"removeClass":function(e,n){for(var t=e.className.split(" "),o=[],r=0;r<t.length;r++){strEquals(t[r],n,!0)||o.push(t[r])}e.className=o.join(" ")}},Visibility={"Visible":["block","visible"],"Hidden":["","hidden"],"Removed":["none",""],"Default":["",""]},NodeType={"Element":1,"Attribute":2,"Text":3,"CDATA":4,"EntityRef":5,"Entity":6,"ProcInst":7,"Comment":8,"Doc":9,"DocType":10,"DocFrag":11,"Notation":12},PrintRecoveryCodeTemplate="<body dir='{0}'><h1>{1}</h1><p>{2}</p><p>{3}</p><p>{4} <b>{5}</b></p><p>{6} {7} (UTC)</p><p>{8} {9}</p></body>";
JSMPnumber.prototype={"size":1,"data":[0]},function(){function e(){function e(){i=!1}function n(e){var n=t("[autofocus],[autofocus=autofocus],[autofocus=true]",e).first();return 0==n.length&&(n=t("input,button,a,select,textarea",e).first()),0===n.length&&(n=t("[role='dialog']")),n}var i,s=this;this.$=t(this),s.dispose=function(){e()},s.modalDialog=function(c,l,u,d,f,p){e();var v=u&&u.options?u.options:r,m=t.extend({"dismissOnButtonClick":!1},p?p.options:null),h=t.extend({},p?p.controlOptions:null),g=[],w=p&&p.shouldReturnFocusOnClose===!1?!1:!0;
if(w&&"undefined"==typeof m.returnFocusTo&&t.extend(m,{"returnFocusTo":t(document.activeElement)}),p&&p.flowEnabled){var C=new o.Account.Controls.FlowController(t(l),p.viewContext,p.flowControllerOptions);C.setStateChangeFunc(p.flowControllerOptions.validateStateChange),C.$.on(C.events.stateChanged,p.flowControllerOptions.stateChangedEvent),C.show(p.flowControllerOptions.startState);var y=s.$;d={"action":function(){return y.trigger("action"),!0},"afterDismiss":function(){return y.trigger("cancel"),!1}}}var b=o.Controls.Notifications.createModalDialog({"title":c,"content":l,"buttons":u,"buttonOptions":v,"options":m,"controlOptions":h});
t(b).bind("buttonclick.dialog",function(e,n,o){var r=!1;d&&(o&&d[o]?r=d[o](o,n):d.dismiss&&(r=d.dismiss(o||"dismiss",n))),r||null==n||t("#OuterContainer").modal("hide")}),i=!0,t(b).bind("aftershow.dialog",function(){d.afterShow&&d.afterShow(b),t(b).unbind("aftershow.dialog")}),b.show().then(function(){t(b).unbind(".dialog"),i=!1,g.forEach(function(e){e.state?t(e.elm).attr("aria-hidden",e.state):t(e.elm).removeAttr("aria-hidden")}),d.afterDismiss&&d.afterDismiss(b)});var E=t("#OuterContainer");return E.modal("show").on("shown.bs.modal",function(){var e=["DialogUserTitle"],o=t("#DialogUserContent",E),r=t(".ariaDescription",o);
r.length>0?t.each(r,function(n,o){var r=t(o),i=r.attr("id");i||(i="dlgAutoId_"+a,r.attr("id",i),a++),e.push(i)}):e.push("DialogUserContent");var i=n(E);$B.Firefox||$B.Chrome?(e.push(i.attr("aria-labelledby")||i.attr("id")),i.attr("aria-labelledby",e.join(" "))):t("[role='dialog']",E).attr("aria-describedBy",e.join(" ")),t.each(t("body").children().not(".ModalDialog, script"),function(e,n){g.push({"elm":n,"state":t(n).attr("aria-hidden")||null}),t(n).attr("aria-hidden","true")}),i.focus()}),E.on("hidden.bs.modal",function(){b.dismiss()
}),b},s.hidePopover=function(){e()},s.isDialogOpened=function(){return i}}var n=window,t=n.jQuery,o=n.wLive,r={"renderOrder":"action,alternate,close"},a=1;e.__class=!0,$Do.when("NotificationControls",0,function(){o.Controls.Notifications.getQueue().start()}),registerNamespace("wLive.Account"),o.Account.DialogManager=new e}();var PasswordValidation={"MinComplexity":2,"MinComplexityStrong":3,"MinLength":8,"Success":0,"Errors":{"NullOrEmpty":1005,"ConfirmPasswordDoesNotMatch":1006,"TooShort":1007,"InvalidCharacters":1008,"NewPasswordSameAsOldPassword":1015,"NotComplexEnough":1261,"NotStrong":1139},"ValidCharRegex":/^[\x20-\x7E]+$/,"CharSets":[/[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+/,/[\x30-\x39]+/,/[\x41-\x5A]+/,/[\x61-\x7A]+/],"RequireStrong":!1,"ContainsForbiddenWord":function(){return!1
},"Validate":function(e,n,t){if(null==e||""==e){return PasswordValidation.Errors.NullOrEmpty}if(e.length<PasswordValidation.MinLength){return PasswordValidation.Errors.TooShort}if(!e.match(PasswordValidation.ValidCharRegex)){return PasswordValidation.Errors.InvalidCharacters}for(var o=0,r=0;r<PasswordValidation.CharSets.length&&(e.match(PasswordValidation.CharSets[r])&&o++,!(o>=PasswordValidation.MinComplexity&&(!PasswordValidation.RequireStrong||o>=PasswordValidation.MinComplexityStrong)));r++){}if(o<PasswordValidation.MinComplexity){return PasswordValidation.Errors.NotComplexEnough
}if(PasswordValidation.RequireStrong){if(o<PasswordValidation.MinComplexityStrong){return PasswordValidation.Errors.NotStrong}if(PasswordValidation.ContainsForbiddenWord&&PasswordValidation.ContainsForbiddenWord(e)){return PasswordValidation.Errors.NotStrong}}return null!=n&&e!=n?PasswordValidation.Errors.ConfirmPasswordDoesNotMatch:null!=t&&e==t?PasswordValidation.Errors.NewPasswordSameAsOldPassword:PasswordValidation.Success}};!function(){function e(e,n){var t=this,o=e||{},a=o.data||{},l=s.getTokenType(a.token)===s.Types.hip;
t.makeRequest=function(e){function n(n){a.isSubmitSuccess=!0,o.resolve(n,e)}function t(n){o.reject(n,e)}var o=new r.Deferred,s=a.selectedProof&&a.selectedProof.epid,u={"token":a.token,"purpose":a.purpose,"epid":s,"confirmProof":a.proofEntry};l&&(u.signinName=a.signinName||null,u.hipSolution=a.hipSolution||null);var d=new i(null,c.sendOtt,u,n,t);return d.start(),o.promise()}}var n=window,t=n.wLive,o=t.Account,r=n.jQuery,a=n.$Config.WLXAccount,i=t.Core.DataRequest,s=o.TokenHelper,c=a.urls.dataRequest;registerNamespace("wLive.Account.DataRequestors"),t.Account.DataRequestors.SendOttDataRequestor=e
}(),function(){function e(e,n){function t(){T.emailMaxLength=113,T.matchDigits=r.matchDigits||4,T.showErrors=o.observable(!1),T.pageTitle=o.observable(R.pageTitle),T.pageDescription=o.observable(R.pageDescription),g(),w(),y(),C(),T.selectedProofIndex(H)}function g(){T.proofList=o.observable(L.proofList),T.proofListErrorMessage=o.observable(null),T.proofSubmitErrorMessage=o.observable(null),T.selectedProofIndex=o.observable(null),T.proofs=o.computed(function(){var e=T.proofList();if(e&&I){var n=o.utils.arrayFilter(e,function(e){return!e.used
});return o.utils.arrayForEach(n,function(e,n){e.index=String(n)}),n}return e}),T.selectedProof=o.computed(function(){var e=T.selectedProofIndex();return e||0===e?T.proofs()[Number(e)]:null}),T.hasProofs=o.computed(function(){var e=T.proofList();return e&&e.length>0&&e[0].type!==f}),T.selectedActionType=o.computed(function(){var e=T.selectedProof();if(e){switch(e.type){case s:case c:return M.OTC;case l:case u:return M.TOTP;case d:return M.SQSA;case f:return M.RecoveryCode}}return""})}function w(){var e=$Config.isINT;
T.proofEntryEmail=o.observable("").extend({"proofClearPortionMatchEmail":{"onlyIf":function(){return A(T.selectedProof())},"params":{"allowZero":e,"clearPortion":E,"domainPortion":function(){var e=T.selectedProof();return T.getDomainPortion(e)},"patterns":[r.AltEmailRegEx],"toString":E},"message":i.proofInputMissingEmail}}).extend({"notify":"always"}),T.proofEntryEmail.focused=o.observable(!1),T.proofEntrySms=o.observable("").extend({"proofClearPortionMatchPhone":{"onlyIf":function(){return S(T.selectedProof())
},"params":{"allowZero":e,"clearPortion":E,"matchDigits":T.matchDigits,"toString":E},"message":i.proofInputMissingSms}}).extend({"notify":"always"}),T.proofPickerAction=o.observable(),T.proofEntry=o.computed(function(){if(T.proofPickerAction()===m){var n=T.selectedProof();if(A(n)){var t=T.proofEntryEmail();return(!e||"0"!==String(t))&&t.indexOf("@")<0&&(t+=P(n)),t}if(S(n)){return T.proofEntrySms()}}return null})}function C(){T.selectedProofIndex.subscribe(function(){T.showErrors(!1);var e=T.selectedProof();e&&(e.requiresReentry?(T.proofEntryEmail(""),T.proofEntrySms("")):A(e)?T.proofEntryEmail(e.autoProofEntry):S(e)&&T.proofEntrySms(e.autoProofEntry)),T[h]&&T[h]()
}),T.selectedProof.subscribe(function(e){var n=!x(e)||D;T.isNextButtonEnabled(n),"undefined"!=typeof WIZARDUI&&WIZARDUI.setButtonState&&(WIZARDUI.fNextEnabled=n,WIZARDUI.setButtonState(WIZARDUI.fBackEnabled,WIZARDUI.fNextEnabled,WIZARDUI.fLastPage))}),T.proofPickerAction.subscribe(function(e){L.proofPickerAction=e}),T.proofPickerAction(m)}function y(){T.actionButtonText=o.computed(function(){return k(T.selectedProof())?a.sendCode:a.next}),T.isNextButtonEnabled=o.observable(null!==T.selectedProofIndex()&&T.selectedProofIndex()>=0)
}function b(e){var n=e&&e.name;if(S(e)){return n.replace(/[^\d]/g,"")}if(A(e)){var t=n.split("@",1)[0];return t.replace(/\*/g,"")}return n}function E(){return b(T.selectedProof())}function P(e){return A(e)?"@"+e.name.split("@",2)[1]:null}function A(e){var n=e&&e.type;return n===s||n===c&&e.name.indexOf("@")>=0}function S(e){return e&&e.type===c&&!A(e)}function k(e){var n=e&&e.channel;return N(e)&&n!==v}function N(e){var n=e&&e.type;return n===s||n===c}function x(e){return e&&e.type===f}var T=this,L=e.data,H=L.selectedProofValue,R=n||{},I=R.processProofsForDropdown,D=L.isAutoCsrSupported,M={"OTC":"OTC","TOTP":"TOTP","SQSA":"SQSA","RecoveryCode":"RecoveryCode"};
T.isAutoCsrSupported=D,T.getProofOptionText=function(e){var n=e.name,t=e.channel,o="";switch(e.type){case s:o=a.proofOptionEmailFormat.format(n);break;case c:t===p?o=a.proofOptionSmsFormat.format(n):t===v&&(o=a.proofOptionVoiceFormat.format(n));break;case l:o=a.proofOptionTotp;break;case u:o=a.proofOptionTotpV2;break;case d:o=a.proofOptionSqsa;break;case f:o=a.proofOptionLost}return e.used&&(o=a.proofOptionUsed.format(o)),o},T.getDomainPortion=P,T.isEmailOrMce=A,T.isPhone=S,T.isAddressable=N,T.isLostOption=x,T.acsrHelpText=a.acsrHelpText,T.isEmailReentryRequired=function(e){return A(e)&&e.requiresReentry
},T.isPhoneReentryRequired=function(e){return S(e)&&e.requiresReentry},T.getReentryCaption=function(e){return A(e)?a.proofInputLabelEmail:S(e)?e.channel===v?a.proofInputLabelVoice.format(T.matchDigits,b(e)):a.proofInputLabelSms.format(T.matchDigits,b(e)):""},T.isValid=function(){var e=T.selectedProof(),n=T.isEmailReentryRequired(e)&&!T.proofEntryEmail.isValid(),t=T.isPhoneReentryRequired(e)&&!T.proofEntrySms.isValid();return!n&&!t},T.setOptionData=function(e,n){o.applyBindingsToNode(e,{"attr":{"id":"proofOption"+n.index,"data-type":n.type,"data-channel":n.channel}},n)
},t()}var n=window,t=n.wLive,o=(t.Account,n.ko),r=n.$Config.WLXAccount,a=(r.proofPicker,r.strings.proofPicker),i=a.errors,s="Email",c="Sms",l="TOTPAuthenticator",u="TOTPAuthenticatorV2",d="SQSA",f="CSS",p="SMS",v="Voice",m="action",h="onProofSelectionChange";registerNamespace("wLive.Account.ViewModels"),t.Account.ViewModels.ProofPickerViewModel=e}(),function(){function e(e,t,o){function r(){G=new d.PageDialogControl($,U,W),K=G.$,z=x()}function s(e){Q.proofSubmitErrorMessage(e||null)}function S(){var e=X.selectedProof,n=X.selectedActionType;
if(n===tn.SQSA){t.actionType=n,B.triggerHandler(m,{"actionName":b,"control":q})}else{if(e&&n===tn.TOTP){B.triggerHandler(m,{"actionName":b,"control":q})}else{if(e&&n===tn.OTC){Z.showLoading(),G&&G.setEnabled(!1);var o=Q.proofEntry();if(Q.isValid()){var r={"success":function(){s(null),Z.hideLoading(!0),B.triggerHandler(m,{"actionName":b,"control":q})},"failure":function(e){if(Q.selectedProofIndex(null),Z.hideLoading(),G&&G.setEnabled(!0),e&&e.error){var n=e.error.code,t=F(n);s(t)}else{s(null)}}};T(r,e.epid,o)
}else{Z.hideLoading(),G.setEnabled(!0),a("#proofInput"+X.selectedProofValue,$).focus()}}else{n===tn.RecoveryCode?B.triggerHandler(m,{"actionName":E,"control":q}):s(l.emptyField)}}}}function k(){if(K){var e=G.events;K.on(e.action,L),K.on(e.setupEvents,I),K.on(e.removeEvents,D),K.on(e.createContent,R),K.on(e.show,M),K.on(e.hide,O)}}function N(){if(K){var e=G.events;K.off(e.action),K.off(e.setupEvents),K.off(e.removeEvents),K.off(e.createContent),K.off(e.show),K.off(e.hide)}}function x(){var e=new a.Deferred;if(X.forceProofRefresh){X.proofList=[];
var n={"token":Y};en&&(n.signinName=X.signinName||null,n.hipSolution=X.hipSolution||null);var t=new v(null,u.getPurposeProofs,n,function(n){V=X.proofList=n.proofs,X.forceProofRefresh=!1,e.resolve(n)},function(n){e.reject(n)});t.start()}else{e.resolve({"proofs":X.proofList})}return e.promise()}function T(e,n,t){var o={"token":Y,"purpose":j,"epid":n,"confirmProof":t,"proofRequiredReentry":X.selectedProof.requiresReentry};en&&(o.signinName=X.signinName||null,o.hipSolution=X.hipSolution||null);var r=new v(null,u.sendOtt,o,e.success,e.failure);
r.start()}function L(e,n){var t=n.actionName;return Q.proofPickerAction(t),H(),t===b?(Q.showErrors(!0),S()):B.triggerHandler(m,{"actionName":t,"control":q}),e&&(e.preventDefault(),e.stopPropagation()),!1}function H(){X.selectedProof=Q.selectedProof(),X.selectedProofValue=Q.selectedProofIndex(),X.selectedActionType=Q.selectedActionType(),X.proofEntry=Q.proofEntry()}function R(e,n){var t=n.content;J=a(P,t)}function I(e,t){var o=t.content;Q=t.viewModel,z.done(function(e){if(!_){Q.proofList(e.proofs),Q.onProofSelectionChange=function(){s(null)
},Q.hasProofs()||Q.pageDescription(c.pageDescriptionNoProofs);var t=X&&X.selectedProofValue;if(i.isWin10InclusiveOOBE&&Q.hasProofs()&&!t&&Q.selectedProofIndex(0),X.serverError){var o=F(X.serverError);s(o),X.serverError=null}}var r=n.MSA&&n.MSA.CXH;i.isWin10InclusiveOOBE&&r&&r.handleBackButton(function(){B&&B.triggerHandler(m,{"actionName":"cancel","control":q})})}),B.triggerHandler(w,{"content":o,"control":q})}function D(e,n){var t=n.content;a(P,t).undelegate(),B.triggerHandler(C,{"content":t,"control":q})}function M(e,n){var t=n.content;
Z=new d.LoadingIndicatorControl(a(".loadingArea",t));var o=G.getButton("action");f.getTokenType(X.token)==f.Types.reset&&a("#"+W.sectionId,$).attr("data-onemore","1"),z.done(function(e){if(!_&&e&&e.proofs){var n=Q.selectedProofIndex(),o=null;n&&(o=J.find(".proofOption[value='"+n+"']"));var r=W.focusElemSelector;o&&o.length>0?setTimeout(function(){o.focus()},0):r&&setTimeout(function(){a(r,t).not(":disabled").first().focus()},0)}}).fail(function(){_||(Q.proofListErrorMessage(l.generic),o.attr("disabled","disabled"),p&&p.setWizardButtons(!0,!1,!1))
}).always(function(){_||(nn=!0,Z.hideLoading())}),nn||Z.showLoading(),B.triggerHandler(h,{"content":n.content,"control":q})}function O(e,n){B.triggerHandler(g,{"content":n.content,"control":q})}function F(e){switch(e){case"1204":case"1211":return X.isOttLimitReached=!0,l.ottLimitReached;case"1035":return l.invalidEmail;case"6001":return l.expiredCreds;default:return l.generic}}var V,q=this,B=a(q),_=!1,$=e,W=o,U=t,X=U.data,Q=null,G=null,K=null,z=null,j=X.purpose=W.proofPurpose||A,Z=null,J=null,Y=X.token||"",en=f.getTokenType(Y)==f.Types.hip,nn=!1,tn={"OTC":"OTC","TOTP":"TOTP","SQSA":"SQSA","RecoveryCode":"RecoveryCode"};
q.show=function(){k(),G&&G.show()},q.hide=function(){G&&G.hide(),N()},q.isReady=function(){return z},q.dispose=function(){_||(B.triggerHandler(y,{"control":q}),Z&&(Z.dispose(),Z=null),N(),G&&(G.dispose(),G=null,K=null),_=!0),q=null,B=null,$=null,W=null,U=null},r()}var n=window,t=n.wLive,o=t.Core,r=t.Account,a=n.jQuery,i=n.$Config.WLXAccount,s=i.strings,c=s.proofPicker,l=(c.errors,s.errors),u=i.urls.dataRequest,d=r.Controls,f=r.TokenHelper,p=null,v=o.DataRequest,m="onAction",h="onShow",g="onHide",w="onSetupEvents",C="onRemoveEvents",y="onDispose",b="action",E="markLost",P="#iProofList",A="RecoverUser";
$Do.when("ExternalHelper",0,function(){p=n.ExternalHelper}),e.prototype.events={"action":m,"show":h,"hide":g,"setupEvents":w,"removeEvents":C,"dispose":y},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.ProofPickerControl=e,$Do.register("ProofPickerControl")}(),function(){function e(e,n,t){function o(){$=new f.PageDialogControl(F,q,V),W=$.$}function r(e){G.showLoading(),$&&$.setEnabled(!1);var n=_.enterVerificationInput();if(c()){var t={"success":function(n){if(_.enterVerificationInput.serverError(""),X||G.hideLoading(),p.getTokenType(B.token)==p.Types.authz){B.isPasswordExpiryEnabled=n.isPasswordExpiryEnabled,B.showExpirationCheckbox=n.isPasswordExpiryEnabled;
var t=n.isPasswordConvergence,o=n.isSkypeOnly;B.isSkypeOnly=o,t&&o!==!0&&(B.isPasswordConvergence=t,B.pageTitle=s.passwordConvergenceTitle,B.descriptionText=s.passwordConvergenceDescription,B.memberName=n.microsoftAccountName,B.skypeName=n.skypeName,B.usernameDesc=s.usernameDescText&&s.usernameDescText.format(n.microsoftAccountName,n.skypeName),B.passwordDesc=s.passwordDescText)}M.triggerHandler(h,{"actionName":e,"control":D})},"failure":function(e){G.hideLoading(Z),$&&$.setEnabled(!0);var n=u.generic;if(e&&e.error){var t=e.error.code;
n=t===P?u.expiredCreds:z===en.SQSA?t===E?l.sqsaLimitReached:l.invalidSqsa:l.invalidCode}_.enterVerificationInput.serverError(n),_.enterVerificationInput.isModified(!1),setTimeout(function(){_.enterVerificationInput.focused(!0)},0)}};_.hideError(_.resendCode),N(t,n)}else{G.hideLoading(Z),$&&$.setEnabled(!0),_.enterVerificationInput.suppressMessages(!1),setTimeout(function(){_.enterVerificationInput.focused(!0)},0)}}function c(){return _.enterVerificationInput.isValid()&&!_.enterVerificationInput.serverError()
}function S(){if(W){var e=$.events;W.on(e.action,x),W.on(e.setupEvents,T),W.on(e.removeEvents,L),W.on(e.createContent,H),W.on(e.show,R),W.on(e.hide,I)}}function k(){if(W){var e=$.events;W.off(e.action),W.off(e.setupEvents),W.off(e.removeEvents),W.off(e.show),W.off(e.hide)}}function N(e,n){var t="",o=j&&j.epid||"";z!==en.SQSA?t=Y(null,n,"saproof",null):(t=Y(null,n.trim().substr(0,32),"proof",null),t+=":::"+Y(null,n.trim().substr(0,32),"saproof",null));var r={"token":K,"purpose":U,"publicKey":J,"encryptedCode":t,"action":z,"confirmProof":B.proofEntry,"epid":o,"proofRequiredReentry":j.requiresReentry};
p.getTokenType(K)==p.Types.hip&&(r.signinName=B.signinName||null,r.hipSolution=B.hipSolution||null);var a=new v(null,d.verifyCode,r,function(n){n&&(B.token=K=n.token,B.forceProofRefresh=!0,B.selectedProof&&(B.selectedProof.used=!0,B.verifiedProofs=B.verifiedProofs||[],B.verifiedProofs.push(B.selectedProof)),B.selectedProof=null,B.selectedProofValue=null,B.selectedActionType=""),e.success(n)},e.failure);a.start()}function x(e,n){var t=n.actionName;return"action"===t?r(t):M.triggerHandler(h,{"actionName":t,"control":D}),e&&(e.preventDefault(),e.stopPropagation()),!1
}function T(e,n){var t=n.content;_=n.viewModel,i.isWin10InclusiveOOBE&&m&&(m.handleBackButton(function(){M&&M.triggerHandler(h,{"actionName":"cancel","control":D})}),Q&&m.showBackButton(!0)),M.triggerHandler(C,{"content":t,"control":D})}function L(e,n){Q&&m&&m.showBackButton(!1),M.triggerHandler(y,{"content":n.content,"control":D})}function H(){}function R(e,n){var t=n.content;G=new f.LoadingIndicatorControl(a(".loadingArea",t)),p.getTokenType(B.token)==p.Types.reset&&a("#"+V.sectionId,F).attr("data-onemore","1"),X&&setTimeout(function(){_.enterVerificationInput.focused(!0)
},10),M.triggerHandler(g,{"content":n.content,"control":D})}function I(e,n){M.triggerHandler(w,{"content":n.content,"control":D})}var D=this,M=a(D),O=!1,F=e,V=t,q=n,B=q.data,_=null,$=null,W=null,U=V.proofPurpose||A,X=i.isXbox,Q=(i.isWin10,i.isLockScreenSscr),G=null,K=B.token||"",z=B.selectedActionType,j=B.selectedProof,Z=V.callbacks&&V.callbacks.context&&V.callbacks.context.props&&V.callbacks.context.props.fKeyboardEnabled,J=SKI,Y=Encrypt,en={"OTC":"OTC","TOTP":"TOTP","SQSA":"SQSA"};D.show=function(){S(),$&&$.show()
},D.hide=function(){$&&$.hide(),k()},D.dispose=function(){O||(M.triggerHandler(b,{"control":D}),G&&(G.dispose(),G=null),k(),$&&($.dispose(),$=null,W=null),O=!0),D=null,M=null,F=null,V=null,_.dispose(),_=null,n=null,t=null},o()}var n=window,t=n.wLive,o=t.Core,r=t.Account,a=n.jQuery,i=n.$Config.WLXAccount,s=i.strings,c=s.verifyCode,l=c.errors,u=s.errors,d=i.urls.dataRequest,f=r.Controls,p=r.TokenHelper,v=o.DataRequest,m=n.MSA&&n.MSA.CXH,h="onAction",g="onShow",w="onHide",C="onSetupEvents",y="onRemoveEvents",b="onDispose",E="1034",P="6001",A="RecoverUser";
e.prototype.events={"action":h,"show":g,"hide":w,"setupEvents":C,"removeEvents":y,"dispose":b},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.VerifyIdentityControl=e}(),function(){function e(e,n){function t(){o(),c(),w(),C(),y(),b()}function o(){A.showButtons=a.observable(B)}function c(){A.previousAction=a.observable(I),A.isSqsa=H===z.SQSA,A.enterVerificationPrompt=a.computed(function(){switch(H){case z.OTC:if(A.previousAction()===m){switch(O){case d:return V?s.enterEmailCodePrompt.format(D):s.enterEmailCodePromptWithoutReentry.format(M);
case f:return F===v?V?s.enterVoiceCodePrompt.format(D,_):s.enterVoiceCodePromptWithoutReentry.format(M):M.indexOf("@")>=0?V?s.enterEmailCodePrompt.format(D):s.enterEmailCodePromptWithoutReentry.format(M):V?s.enterSmsCodePrompt.format(D,_):s.enterSmsCodePromptWithoutReentry.format(M)}}return s.enterOtcPrompt.format(M);case z.TOTP:return s.enterTotpPrompt;case z.SQSA:return s.enterSqsaPrompt.format('<span class="bold">'+M.encodeHtml()+"</span>")}}),A.enterVerificationHeaderText=a.pureComputed(function(){switch(H){case z.OTC:switch(O){case d:return s.enterCodeHeaderEmail;
case f:return F===v?s.enterCodeHeaderVoice:s.enterCodeHeaderSms}case z.TOTP:return s.enterCodeHeaderTotp}return""}),A.enterVerificationDescriptionText=a.pureComputed(function(){switch(H){case z.OTC:switch(O){case d:return s.enterCodeDescEmail.format(M);case f:return F===v?s.enterCodeDescVoice.format(M):s.enterCodeDescSms.format(M)}}return""}),A.enterVerificationLabel=a.pureComputed(function(){switch(H){case z.SQSA:return s.enterSqsaPrompt.format(M)}return s.enterVerificationDefaultLabel}),A.enterVerificationPlaceholder=a.pureComputed(function(){switch(H){case z.SQSA:return s.enterSqsaPlaceholder
}return s.enterVerificationDefaultPlaceholder}),A.enterVerificationInput=a.observable().extend({"required":{"params":!0,"message":u.emptyField}}).extend({"allPatterns":{"onlyIf":function(){return H===z.OTC},"params":[W],"message":X}}).extend({"allPatterns":{"onlyIf":function(){return H===z.TOTP},"params":[U],"message":l.invalidCode}}),A.enterVerificationInput.serverError=a.observable(k.serverError||""),A.enterVerificationInput.suppressMessages=a.observable(!k.hasServerError),A.enterVerificationInput.focused=a.observable(k.hasServerError||q).extend({"notify":"always"})
}function w(){A.isResendCodeEnabled=a.observable(S.isResendCodeSupported&&S.resendCodeTimeout&&S.resendCodeCountdownVisibleTime&&H===z.OTC&&O===f&&F===p&&!R&&(A.previousAction()===m||!L.requiresReentry)),A.resendCodeTimer=a.observable(null),A.resendCode=function(){A.isResendCodeEnabled()&&P()},A.resendCode.serverError=a.observable(""),A.resendCode.suppressMessages=a.observable(!0),A.isResendCodeEnabled()&&(A.startResendCodeTimer=function(){A.resendCodeTimer(K),A.timer=setInterval(function(){var e=A.resendCodeTimer()-1;
0>=e&&(clearInterval(A.timer),A.timer=null),A.resendCodeTimer(e)},1e3)},A.startResendCodeTimer())}function C(){A.revertLinkText=a.pureComputed(function(){return T?s.proofPickerLinkText:s.acsrLinkText}),A.showRevertLink=T||x,A.isResendCountDownVisible=a.computed(function(){if(A.isResendCodeEnabled()&&A.resendCodeTimer()>0){var e=K-A.resendCodeTimer();return e>G}return!1}),A.isResendCodeLinkVisible=a.computed(function(){return A.isResendCodeEnabled()&&0===A.resendCodeTimer()}),A.resendCodeSuccessVisible=a.observable(!1),A.resendCodeText=a.computed(function(){return A.isResendCountDownVisible()?s.proofResendCodeWaiting.format(E(A.resendCodeTimer())):A.isResendCodeLinkVisible()?s.proofResendCode:A.resendCodeSuccessVisible()?s.proofResendCodeSuccess:""
}),A.resendCodeRole=a.computed(function(){return A.isResendCountDownVisible()?g:null})}function y(){A.showError=function(e){return e.suppressMessages()?e.serverError():e.isValid&&!e.isValid()||e.isModified&&!e.isModified()&&e.serverError()},A.hideError=function(e){e.serverError(""),e.suppressMessages(!0)}}function b(){A.enterVerificationInput.subscribe(function(){A.hideError(A.enterVerificationInput)})}function E(e){var n=Math.floor(e/60),t=e%60;return 10>t&&(t="0"+t),n+":"+t}function P(){function n(){A.resendCodeSuccessVisible(!0),A.previousAction(m),A.hideError(A.resendCode),A.startResendCodeTimer()
}function t(e){A.resendCodeSuccessVisible(!1),A.isResendCodeEnabled(!1);var n=u.generic;if(e&&e.error){var t=e.error.code;switch(t){case"1204":case"1211":n=u.ottLimitReached;break;case"1035":n=u.invalidEmail;break;case"6001":n=u.expiredCreds}}A.resendCode.suppressMessages(!1),A.resendCode.serverError(n)}N||(N=new r.SendOttDataRequestor(e)),N.makeRequest().done(n).fail(t)}var A=this,S=n||{},k=e.data,N=null,x=k.isAutoCsrSupported,T=k.isProofPickerAvailable,L=k.selectedProof,H=k.selectedActionType,R=k.isOttLimitReached,I=k.proofPickerAction,D=k.proofEntry,M=L.name,O=L.type,F=L.channel,V=L.requiresReentry,q=S.focusFirstInput,B=S.showButtons,_=i.matchDigits||4,$=S.codeLength||0,W=S.codeRegex||"^\\d+$",U="^\\d+$",X=$?l.invalidCodeFormat.format($):l.invalidCode,Q=S.resendCodeTimeout||0,G=(S.resendCodeCountdownVisibleTime||0)+h,K=Q+h,z={"OTC":"OTC","TOTP":"TOTP","SQSA":"SQSA"};
A.dispose=function(){A.timer&&(clearInterval(A.timer),A.timer=null)},t()}var n=window,t=n.wLive,o=t.Account,r=o.DataRequestors,a=n.ko,i=n.$Config.WLXAccount,s=i.strings.verifyCode,c=i.strings,l=s.errors,u=c.errors,d="Email",f="Sms",p="SMS",v="Voice",m="action",h=5,g="timer";registerNamespace("wLive.Account.ViewModels"),t.Account.ViewModels.VerifyIdentityViewModel=e}(),function(){function e(e,n){function t(e,n){l.apiRecoverUserSuccess=!0,l.recoveryCode=e.recoveryCode,l.contactEmail=e.contactEmail,l.contactProof=l.contactEmail,l.contactProofTypeClass="email",l.obfuscatedMembername=e.obfuscatedMembername,l.recoveryCodeCreationtime=e.creationTime,l.enableTfa=e.enableTfa,l.token=null,l.password=null,delete l.token,delete l.password,delete l.passwordExpiryEnabled,n.deferred.resolve(e,n.params)
}function a(e,n){l.apiRecoverUserSuccess=!1,n.deferred.reject(e,n.params)}var i=this,s=e||{},l=s.data||{};i.makeRequest=function(e){var n=new o.Deferred,i={"token":l.token,"contactEmail":l.contactEmail,"contactEpid":l.contactEmailEpid,"emailRecoveryToken":l.emailRecoveryToken,"publicKey":SKI,"password":e.password,"passwordExpiryEnabled":e.enableExpiration},s=new r(null,c.eaRecoverUser,i,t,a,null,{"deferred":n,"params":e});return s.start(),n.promise()}}var n=window,t=n.wLive,o=n.jQuery,r=t.Core.DataRequest,a=n.$Config.WLXAccount,i=a[a.featureNamespace||"updatePassword"],s=i.urls,c=s.dataRequest;
registerNamespace("wLive.Account.DataRequestors"),t.Account.DataRequestors.RecoverUserDataRequestor=e}(),function(){function e(e,n){var t=this,a=e||{},i=a.data||{};t.makeRequest=function(e){function n(n){i.apiResetPasswordSuccess=!0,i.enableTfa=n.enableTfa,a.resolve(n,e)}function t(n){a.reject(n,e)}var a=new o.Deferred,s=Encrypt("","",l,e.password),u=i.verifiedProofs&&i.verifiedProofs[0]&&i.verifiedProofs[0].epid,d=i.verifiedProofs&&i.verifiedProofs[1]&&i.verifiedProofs[1].epid,f={"encryptedPwd":s,"publicKey":SKI,"token":i.token,"expiryEnabled":e.enableExpiration,"signinName":i.signinName,"epid":u,"tfaEpid":d},p=new r(null,c.resetPassword,f,n,t);
return p.start(),a.promise()}}var n=window,t=n.wLive,o=n.jQuery,r=t.Core.DataRequest,a=n.$Config.WLXAccount,i=a[a.featureNamespace||"updatePassword"],s=i.urls,c=s.dataRequest,l="newpwd";registerNamespace("wLive.Account.DataRequestors"),t.Account.DataRequestors.ResetPasswordDataRequestor=e}(),function(){function e(e,n){function t(){f.pageTitle=m.pageTitle||h.pageTitle,f.submitted=ko.observable(!1);var e=m.memberName;f.memberName=e;var n=m.skypeName;f.skypeName=n,f.showExpirationCheckbox=m.showExpirationCheckbox,f.forcePasswordExpiration=m.forcePasswordExpiration,f.isPasswordConvergence=m.isPasswordConvergence,f.showUsername=e&&m.showUserName;
var t=e&&e.toUpperCase(),r=n&&n.toUpperCase();f.showSkypeName=f.isPasswordConvergence&&t!==r,f.isCurrentPasswordRequired=h.isCurrentPasswordRequired,f.isPasswordReentryRequired=h.isPasswordReentryRequired,f.showForgotPasswordLink=h.showForgotPasswordLink,f.showPrivacyLink=h.showPrivacyLink,f.handleCapsLockWarning=h.handleCapsLockWarning,f.showSkipLink=h.showSkipLink,f.skipLinkText=h.skipLinkText,h.isCurrentPasswordRequired&&(o.extend(f,u()),g.push(f.currentPassword)),f.isCapsLockOn=ko.observable(null),o.extend(f,d()),g.push(f.password),g.push(f.retypePassword),f.expirationChecked=ko.observable(!1),f.showPreferSetNewPassword=h.allowPreferNewPasswordOption,f.preferSetNewPassword=ko.observable(!1),f.showCollectNewPassword=ko.computed(function(){return f.showPreferSetNewPassword?f.preferSetNewPassword():!0
}),f.descriptionText=ko.computed(function(){if(f.showPreferSetNewPassword){var e=f.preferSetNewPassword()?c.setPasswordDescPreferNew:c.setPasswordDesc;return e&&e.format(f.memberName.encodeHtml())}return m.descriptionText||h.descriptionText}),f.usernameDesc=ko.computed(function(){return m.usernameDesc||h.usernameDesc}),f.passwordDesc=ko.computed(function(){return m.passwordDesc||h.passwordDesc}),f.saveInstructions=m.saveInstructions||h.saveInstructions,f.preferSetNewPasswordText=ko.computed(function(){return c.preferSetNewPWDDesc
}),a(),f.retypePasswordAriaLabel=ko.computed(function(){return f.showError(f.retypePassword)?f.retypePassword.error():c.retypePasswordLabel})}function a(){f.errors=ko.validation.group(g),f.errors.showAllMessages(!1),f.isValid=ko.computed(function(){return f.errors().length>0?!1:f.submitted()?!f.getFirstError():!0}),f.isErrorShown=ko.computed(function(){if(0===f.errors().length){return!1}var e=f.getFirstVisibleError();return Boolean(e)})}function u(){var e={},n=ko.observable(v.data.currentPassword||"").extend({"required":{"onlyIf":function(){return f.isCurrentPasswordRequired
},"params":!0,"message":l.required}});return n.serverError=v.data.serverError||"",n.isValidating.subscribe(function(){}),n.focused=ko.observable(!1),e.currentPassword=n,e}function d(){var e={},n=ko.observable(v.data.password||"").extend({"required":{"params":!0,"message":l.required},"minLength":{"params":8,"message":l.passwordShort},"pattern":{"params":i.regex.PwdValidInput,"message":l.passwordBadchar}});n.extend(i.requireStrongPassword?{"strongPwdComplexity":{"params":!0,"message":l.requireStrong}}:{"pwdComplexity":{"params":!0,"message":l.requireStrong}}),i.disableBannedPwdCheck?n.isValidating=ko.observable(!1):n.extend({"bannedPwd":{"params":{"url":s.bannedPwd,"ski":SKI||""},"message":l.bannedPassword}}),n.serverError=v.data.serverError||"",n.isValidating.subscribe(function(){}),n.focused=ko.observable(!1),e.password=n;
var t=ko.observable(v.data.retypePassword||"").extend({"required":{"onlyIf":function(){return f.isPasswordReentryRequired&&n()},"message":l.required},"equal":{"onlyIf":function(){return f.isPasswordReentryRequired&&n()},"params":n,"message":l.passwordNotMatch}});return t.focused=ko.observable(!1),e.retypePassword=t,e}var f=this,p=f.$=o(f),v=e||{},m=v.data||{},h=n,g=[];f.notifyAllSubscribers=function(){o.each(g,function(e,n){n&&!n()&&n.valueHasMutated&&n.valueHasMutated()})},f.isValidating=function(){var e=!1;
return o.each(g,function(n,t){return!(e=e||t.isValidating())}),e},f.setServerError=function(e,n,t){e.serverError=n,e.isModified(!1),t&&setTimeout(function(){e.focused(!0)},0)},f.showError=function(e,n){return f.submitted()?n&&f.getFirstError()!==e?!1:e.isValid&&!e.isValid()||e.isModified&&!e.isModified()&&e.serverError:!1},f.showTooltip=function(e,n){var t=!1,o=e.focused&&e.focused();return o&&!n&&(t=f.isErrorShown()),!t&&o},f.getFirstError=function(){var e=null;return o.each(g,function(n,t){return t.isValid&&!t.isValid()||t.isModified&&!t.isModified()&&t.serverError?(e=t,!1):!0
}),e},f.getFirstVisibleError=function(){var e=null;return o.each(g,function(n,t){return f.showError(t)?(e=t,!1):!0}),e},f.placeholderVisible=function(e){return!e},f.onPasswordKeyPress=function(e,n){var t=n.which||n.keyCode;return f.isCapsLockOn(r.isCapsLockOn(t,n.shiftKey)),!0},f.onPrivacyLinkClick=function(){return p.triggerHandler("privacyLinkClick",{}),!1},f.onForgotPasswordLinkClick=function(){p.triggerHandler("forgotPasswordLinkClick",{})},f.onSkipLinkClick=function(){p.triggerHandler("skipLinkClick",{})
},t()}var n=window,t=n.wLive,o=n.jQuery,r=t.Account.FieldHelper,a=n.$Config.WLXAccount,i=a[a.featureNamespace||"updatePassword"],s=i.urls.dataRequest,c=(i.urls,i.strings),l=c.errors;registerNamespace("wLive.Account.ViewModels"),t.Account.ViewModels.UpdatePasswordViewModel=e}(),function(){function e(e,u,p){function S(){X.pageTitle=G.pageTitle||X.pageTitle,j=new r.PageDialogControl(U,Q,X),Z=j.$}function k(e){var n=K.isCapsLockOn();if(null!==n){var t=e.which||e.keyCode;t==h&&K.isCapsLockOn(!n)}return!0}function N(){Z&&(Z.on(j.events.action,T),Z.on(j.events.setupEvents,O),Z.on(j.events.removeEvents,V),Z.on(j.events.show,q),Z.on(j.events.hide,B))
}function x(){Z&&(Z.off(j.events.action),Z.off(j.events.setupEvents),Z.off(j.events.removeEvents),Z.off(j.events.show),Z.off(j.events.hide))}function T(e,n){j&&j.setEnabled(!1),o(document.activeElement).blur();var t=n.actionName;if(t===m){var r=n.control;L(r)}else{$.triggerHandler(C,{"actionName":t,"control":_})}return e&&(e.preventDefault(),e.stopPropagation()),!1}function L(e){if(K){K.submitted(!0),K.notifyAllSubscribers();var n=null;if(K.isCurrentPasswordRequired&&!K.currentPassword.isValid()?n=K.currentPassword:K.showCollectNewPassword()&&!K.password.isValid()?n=K.password:K.showCollectNewPassword()&&K.isPasswordReentryRequired&&!K.retypePassword.isValid()&&(n=K.retypePassword),n){return j&&j.setEnabled(!0),n.focused(!1),void setTimeout(function(){n.focused(!0)
},0)}}var t={"password":!X.viewModelOptions.allowPreferNewPasswordOption||K.preferSetNewPassword()?K.password():K.currentPassword(),"enableExpiration":null};G.isCurrentPasswordRequired=K.isCurrentPasswordRequired,G.isCurrentPasswordRequired&&(t.currentPassword=K.currentPassword());var r=K.forcePasswordExpiration;(K.showExpirationCheckbox||r)&&(t.enableExpiration=r||K.expirationChecked()),t.removeFedCred=X.removeFedCred;var a=o("#iPostedTicket",U).val();t.userTicket=a,t.token=G.token,nn.makeRequest(t).done(H).fail(R),M(e.content(),"")
}function H(e,t){var o=!1;if(Q&&e){if(G=Q.data||{},G.selectedActionType="",X.viewModelOptions.allowPreferNewPasswordOption&&K.preferSetNewPassword()&&(G.preferSetNewPassword=!0),!X.discardUserData&&l){var r=n.MSA&&n.MSA.CXH;r&&(o=!0,r.encryptUserDataAsync(t.password,function(e){r.propertyBagSetAsync("encPwd",e,I,I,r.ErrorHandlerMode.logAndCustom)},I,r.ErrorHandlerMode.logAndCustom))}G.isAccountCompromisedFlow||(G.token=null,delete G.token)}o||I()}function R(e){var n="";if(G.apiSubmitChangePasswordSuccess=!1,e&&e.error&&e.error.code){G.hasServerError=!0;
var t=K.password;switch(e.error.code){case f.passwordIncorrect:n=d.passwordIncorrect,t=K.currentPassword;break;case f.passwordBadchar:n=d.passwordBadchar;break;case f.passwordShort:n=d.passwordShort;break;case f.questionInPassword:n=d.questionInPassword;break;case f.secretAnswerInPassword:n=d.secretAnswerInPassword;break;case f.wlidInPassword:n=d.wlidInPassword;break;case f.passwordContestedSameLength:n=d.passwordContestedSameLength;break;case f.passwordInHistory:n=d.passwordInHistory;break;case f.bannedPassword:n=d.bannedPassword;
break;case f.changePasswordTicketExpired:case f.authRequired:if(Y){return void D(!0)}n=d.expiredCreds,t=null;break;case f.credentialLockout:if(J){return void D()}n=d.credentialLockout,t=null;break;default:if(J){return void D()}n=d.generic,t=null}t?K.setServerError(t,n,!0):M(j.content(),n),j&&j.setEnabled(!0)}else{D()}}function I(){j&&j.setEnabled(!1),$.triggerHandler(C,{"actionName":"action","control":_})}function D(e){j&&j.setEnabled(!0),e?$.triggerHandler(C,{"actionName":"credRefresh","control":_}):$.triggerHandler(C,{"actionName":"error","control":_})
}function M(e,n){var t=o("#iPageError",e);return n?(t&&(t.text(n),en||(a.addToList(t),en=!0)),!1):(en&&(a.deleteFromListFast(t),en=!1),!0)}function O(e,r){K=r.viewModel,z=K.$,nn=new t.Account.DataRequestors[X.dataRequestor](Q,{}),X.handleCapsLock&&o(document).on(g+w,k),z.on("privacyLinkClick",function(){$.triggerHandler(C,{"actionName":"privacy","control":_})}),z.on("forgotPasswordLinkClick",function(){$.triggerHandler(C,{"actionName":"forgotPwd","control":_})}),z.on("skipLinkClick",function(){F()});var a=n.MSA&&n.MSA.CXH;
s.isWin10InclusiveOOBE&&a&&a.handleBackButton(function(){$&&$.triggerHandler(C,{"actionName":"cancel","control":_})}),$.triggerHandler(E,{"content":r.content,"control":_,"viewModel":K})}function F(){function e(){$.triggerHandler(C,{"actionName":"skip","control":_})}$ReportEvent.Fire("Account_PasswordAccrualPage_SnoozeLink_UserAction");var n={"notificationType":c.notificationType,"notificationAction":c.notificationAction},t=new i(null,v.consumeNotification,n,e,e);t.start(),j&&j.setEnabled(!1)}function V(e,n){o(document).off(g+w),$.triggerHandler(P,{"content":n.content,"control":_})
}function q(e,n){$.triggerHandler(y,{"content":n.content,"control":_})}function B(e,n){$.triggerHandler(b,{"content":n.content,"control":_})}var _=this,$=o(_),W=!1,U=e,X=p,Q=u,G=Q.data,K=null,z=null,j=null,Z=null,J=X.hasErrorTransition,Y=X.hasCredRefreshTransition,en=!1,nn=null;_.show=function(){N(),j&&j.show()},_.hide=function(){j&&j.hide(),x()},_.dispose=function(){W||($.triggerHandler(A,{"control":_}),x(),j&&(j.dispose(),j=null,Z=null),W=!0),_=null,$=null,U=null,X=null,u=null,p=null},S()}var n=window,t=n.wLive,o=n.jQuery,r=t.Account.Controls,a=t.Account.AnimationHelper,i=t.Core.DataRequest,s=n.$Config.WLXAccount,c=s[s.featureNamespace||"updatePassword"],l=s.usesWin10Behavior,u=c.strings,d=u.errors,f=c.errorCodes,p=c.urls,v=p.dataRequest,m="action",h=20,g="keyup",w=".updatepasswordcontrol",C="onAction",y="onShow",b="onHide",E="onSetupEvents",P="onRemoveEvents",A="onDispose";
e.prototype.events={"action":C,"show":y,"hide":b,"setupEvents":E,"removeEvents":P,"dispose":A},registerNamespace("wLive.Account.Controls"),t.Account.Controls.UpdatePasswordControl=e}(),function(){function e(e){function n(){}function t(){var e="";if(r.isAccountNameReadOnly){if(r.isPhoneNumber()&&r.hasPhoneCountryPrefill){var n=o();e=n?"+"+n+" ":""}e+=r.accountName()}return e}function o(){var e="",n=r.phoneCountry(),t=r.phoneCountryList;if(n&&t){for(var o=0,a=t.length;a>o;o++){var i=t[o];if(n.toUpperCase()===i.iso.toUpperCase()){e=i.countryCode;
break}}}return e.replace(/[^0-9]/g,"")}{var r=this,a=e||{},i=a.bindings||{},s=a.options||{};a.prefill||{}}r.value=i.value||ko.observable(null),r.hasFocus=i.hasFocus||ko.observable(!1).extend({"notify":"always"}),r.isPhoneNumber=i.isPhoneNumber||ko.observable(),r.phoneCountry=i.phoneCountry||ko.observable(),r.accountName=i.accountName||ko.observable(),r.isEnabled=i.enabled||ko.observable(!0),r.handleEnterKey=i.enterKeyHandler||function(){return!0},r.labelText=s.labelText,r.placeholderText=s.placeholderText,r.tooltip=s.tooltip||null,r.ariaLabel=s.ariaLabel,r.ariaDescribedBy=s.ariaDescribedBy,r.acsrAriaLabel=s.acsrAriaLabel,r.phoneOrEmailLinkText=s.phoneOrEmailLinkText,r.phoneCountryList=s.phoneCountryList,r.countryListAriaLabel=s.countryListAriaLabel||null,r.isAccountNameReadOnly=Boolean(s.isAccountNameReadOnly),r.hasPhoneCountryPrefill=Boolean(r.phoneCountry()),r.readOnlyAccountName=t(),r.togglePhoneOrEmail=function(){r.isPhoneNumber(!r.isPhoneNumber()),r.hasFocus(!0)
},n()}var n='            <input type="hidden" name="isSigninNamePhone" data-bind="value: isPhoneNumber" />             <!-- ko if: labelText -->             <label class="text-base" for="AccountNameInput" data-bind="text: labelText"></label>             <!-- /ko -->             <!-- ko if: isAccountNameReadOnly -->             <input type="hidden" id="AccountNameInput" name="WlidInput" data-bind="value: accountName" />             <div id="ReadOnlyAccountName" class="dirltr" data-bind="text: accountName" />            <!-- /ko -->             <!-- ko ifnot: isAccountNameReadOnly -->             <!-- ko if: isPhoneNumber() -->             <div id="PhoneCountrySection" class="form-group">                 <select class="form-control email-input-max-width" id="PhoneCountry" name="PhoneCountry"                     data-bind="                        options: phoneCountryList,                         optionsValue: \'iso\',                         optionsText: \'countryCode\',                         value: phoneCountry,                         enable: isEnabled(),                         attr: { \'aria-label\': countryListAriaLabel }"></select>             </div>             <!-- /ko -->             <!-- ko if: placeholderText -->             <div class="form-group">                 <input type="email" id="AccountNameInput" name="WlidInput" class="dirltr form-control email-input-max-width" maxlength="112" lang="en"                     data-bind="                        textInput: accountName,                         hasFocus: hasFocus,                         enable: isEnabled(),                         attr: {                             \'type\': isPhoneNumber() ? \'tel\' : \'email\',                             \'aria-describedby\': ariaDescribedBy,                             \'aria-label\': ariaLabel,                             \'placeholder\': placeholderText },                         event: { keypress: handleEnterKey }" />             </div>             <!-- /ko -->             <!-- ko ifnot: placeholderText -->             <input type="email" id="AccountNameInput" name="WlidInput" class="dirltr form-control email-input-max-width" maxlength="112" lang="en"                 data-bind="textInput: accountName,                 hasFocus: hasFocus,                 enable: isEnabled(),                 attr: {                     \'type\': isPhoneNumber() ? \'tel\' : \'email\',                     readonly: isAccountNameReadOnly,                     \'aria-describedby\': ariaDescribedBy,                     \'aria-label\': acsrAriaLabel }" />             <!-- /ko -->             <div id="iUsePhoneOrEmailLinkDiv" data-bind="visible: isPhoneNumber()">                 <a href="#" id="iUsePhoneOrEmailLink" onclick="return false;" data-bind="text: phoneOrEmailLinkText, click: togglePhoneOrEmail, enable: isEnabled()"></a>             </div>             <!-- /ko -->';
ko.components.register("CollectAccountNameComponent",{"viewModel":e,"template":n})}(),function(){function e(){function e(e){var n="";return g&&g.List&&(n=g.List[e]),n.replace(/[^0-9]/g,"")}function n(e){return e.replace(/[^0-9]/g,"")}function t(e){return!y&&e&&e.match(h)}function u(){d.isAccountNameReadOnly=C;var o=s.phoneCountry;d.accountName=ko.observable(s.accountName||null),d.phoneCountry=ko.observable(o||null),d.isAccountNamePhone=ko.observable(Boolean(s.isPhoneNumber));var a=[m,v];y||a.push(h),d.fullAccountName=ko.pureComputed(function(){var o=d.accountName();
return C||!d.isAccountNamePhone()||o.match(v)||t(o)?o:e(d.phoneCountry())+n(d.accountName())}).extend({"validation":{"validator":function(){return Boolean(d.accountName())},"message":i.emptyField},"onePattern":{"params":a,"message":function(){return d.isAccountNamePhone()?i.invalidPhone:i.accountNameMalformed}}}).extend({"rateLimit":{"timeout":c,"method":l}}),d.fullAccountName.showError=ko.observable(!1),d.accountName.subscribe(function(e){e&&(d.fullAccountName.showError(!0),d.isAccountNamePhone()||e.match(v)||t(e)||!e.match(m)||(b=!0,d.isAccountNamePhone(!0)))
}),d.isAccountNamePhone.subscribe(function(){b?b=!1:(d.accountName(""),d.accountNameError(null),d.fullAccountName.showError(!1))}),d.phoneOrEmailLinkText=ko.pureComputed(function(){return d.isAccountNamePhone()?p:f}),d.accountNameHasFocus=ko.observable(!0).extend({"notify":"always"}),d.accountNameError=ko.observable(r.accountNameServerErrorMessage||null),d.fullAccountName.focused=ko.computed({"read":function(){return d.accountNameHasFocus()},"write":function(e){d.accountNameHasFocus(Boolean(e))}});var u=null,w=[];
for(var E in g.List){w.push({"iso":E,"countryCode":g.List[E]})}u=w,C||d.phoneCountry()||d.phoneCountry(g.Default),d.phoneCountryList=u}var d=this,f=a.usePhone,p=a.useEmail,v=r.signinNameRegex,m=r.phoneNumberRegex||"",h=r.skypeNameRegex||"",g=o.countryList,w=null,C=r.isAccountNameReadOnly,y=r.disallowSkypeName,b=!1;d.validateAccountName=function(){var e=d.fullAccountName();if(!e){return d.accountNameError(i.emptyField),!1}if(C){return!0}var n=e.match(v);if(!n&&!t(e)){var o=e.match(m),r=d.isAccountNamePhone();
if(!r){if(o){var a=d.accountName();return d.isAccountNamePhone(!0),setTimeout(function(){d.accountName(a)},0),!1}return d.accountNameError(i.accountNameMalformed),!1}if(!o){return d.accountNameError(i.invalidPhone),!1}}return d.accountNameError(null),!0},d.isAccountNameSkype=function(){var e=d.accountName()||"";return e.match(h)},d.setEnterKeyHandler=function(e){w=e},d.enterKeyHandler=function(e,n){return w&&13===n.keyCode?(w(e,n),!1):!0},d.isValid=function(){return d.fullAccountName.isValid()},d.notifyAllSubscribers=function(){d.fullAccountName.notifySubscribers(d.fullAccountName())
},u()}var n=window,t=n.wLive,o=n.$Config.WLXAccount,r=o.collectAccountName||{},a=r.strings||{},i=a.errors||{},s=r.prefill||{},c=500,l="notifyWhenChangesStop";registerNamespace("wLive.Account.ViewModels"),t.Account.ViewModels.CollectAccountNameViewModel=e}(),function(){function e(e,n,t){function a(){I=new c.Controls.PageDialogControl(T,n,t),D=r(I)}function f(e,n){function t(n){if(L){L.data=L.data||{},L.data.memberAccount=e,L.data.token=n.token,L.data.isPasswordExpiryEnabled=n.isPasswordExpiryEnabled,L.data.showExpirationCheckbox=n.isPasswordExpiryEnabled;
var t=n.isPasswordConvergence,o=n.isSkypeOnly;L.data.isSkypeOnly=o,t&&o!==!0&&(L.data.isPasswordConvergence=n.isPasswordConvergence,L.data.microsoftAccountName=n.microsoftAccountName,L.data.skypeName=n.skypeName,i&&(L.data.pageTitle=i.passwordConvergenceTitle,L.data.descriptionText=i.passwordConvergenceDescription,L.data.usernameDesc=i.usernameDescText&&i.usernameDescText.format(n.microsoftAccountName,n.skypeName),L.data.passwordDesc=i.passwordDescText))}R.accountNameError(null),N.triggerHandler(l,{"actionName":"action","control":k})
}function r(e){var n=g(String(e&&e.error?e.error.code:m));setTimeout(function(){R.accountNameHasFocus(!0)},0),R.accountNameError(n),k.setEnabled(!0),L&&L.data&&delete L.data.memberAccount}R.accountNameError(null),k.setEnabled(!1);var a={"token":L.data.token,"accountName":e,"phoneCountry":n,"purpose":H},c=new o.DataRequest(null,s.dataRequest.verifyAccount,a,t,r);c.start()}function g(e){if(e&&h[e]){return GetString("live.accounts.strings."+h[e])}var n=GetString("live.accounts.strings.error_"+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+m)),n
}function w(e,n){if("action"===n.actionName){var t=R.fullAccountName();R.validateAccountName()&&f(t,R.phoneCountry())}else{N.triggerHandler(l,{"actionName":n.actionName,"control":k})}e.preventDefault(),e.stopPropagation()}function C(){R.setEnterKeyHandler(function(e,n){w(n,{"control":k,"actionName":"action"})})}function y(e,n){n.content;R=n.viewModel}function b(e,n){N.triggerHandler(p,{"content":n.content,"control":k})}function E(e,n){n.content;L&&L.data&&L.data.contactEmail&&R.accountName(L.data.contactEmail),setTimeout(function(){R.accountNameHasFocus(!0)
},0),C(),N.triggerHandler(u,{"content":n.content,"control":k})}function P(e,n){N.triggerHandler(d,{"content":n.content,"control":k})}function A(){D&&(D.on(I.events.action,w),D.on(I.events.setupEvents,y),D.on(I.events.removeEvents,b),D.on(I.events.show,E),D.on(I.events.hide,P))}function S(){D&&(D.off(I.events.action),D.off(I.events.setupEvents),D.off(I.events.removeEvents),D.off(I.events.show),D.off(I.events.hide))}var k=this,N=r(k),x=!1,T=e,L=n,H=t.purpose,R=null,I=null,D=null;k.show=function(){A(),I&&I.show()
},k.hide=function(){I&&I.hide(),S()},k.setEnabled=function(e){I&&I.setEnabled(e)},k.dispose=function(){x||(N.triggerHandler(v,{"control":k}),S(),I&&(I.dispose(),D=null,I=null)),L=null,R=null,k=null,N=null,x=!0},a()}var n=window,t=n.wLive,o=t.Core,r=n.jQuery,a=$Config.WLXAccount,i=a.strings,s=a.urls;registerNamespace("wLive.Account.Controls");var c=t.Account,l=(c.AnimationHelper,"onAction"),u="onShow",d="onHide",f="onSetupEvents",p="onRemoveEvents",v="onDispose",m="error_1001",h={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"action":l,"show":u,"hide":d,"setupEvents":f,"removeEvents":p,"dispose":v},e.__class=!0,t.Account.Controls.RecoveryValidateMsaControl=e}(),function(){function e(e,n,t){function o(){sn=new u.PageDialogControl(tn,rn,on),cn=sn.$}function r(e){ln.showLoading(),sn&&sn.setEnabled(!1);var n=a("#"+E,tn).val(),t=a("#"+P,tn).val(),o=null;if(hn&&(o=a("#"+A,tn).is(":checked")),q(n,t)){{bn("","",I,n)}an.password=n,an.passwordExpiryEnabled=o,en.triggerHandler(v,{"actionName":e,"control":Y})}else{ln.hideLoading(),sn&&sn.setEnabled(!0)
}}function i(){cn&&(cn.on(sn.events.action,K),cn.on(sn.events.setupEvents,z),cn.on(sn.events.removeEvents,j),cn.on(sn.events.show,Z),cn.on(sn.events.hide,J))}function M(){cn&&(cn.off(sn.events.action),cn.off(sn.events.setupEvents),cn.off(sn.events.removeEvents),cn.off(sn.events.show),cn.off(sn.events.hide))}function O(e){return e?(vn&&(vn.text(e),gn||(f.addToList(vn),gn=!0)),!1):(F(),!0)}function F(){gn&&vn&&(f.deleteFromListFast(vn),gn=!1)}function V(e){var n=String(e),t=GetString(R+"error_"+n);if(!t){switch(n){case"1197":case"6001":t=c.expiredCreds;
break;case S:t=s.pwdInHistory;break;default:t=c.generic}}O(t)}function q(e,n){var t=String(PasswordValidation.Validate(e,n,null));return t&&"0"!==t?(V(t),!1):(F(),!0)}function B(e,n){n.attr("disabled","disabled");var t=sn.getButton("action").attr("disabled","disabled");G(function(o){n.removeAttr("disabled"),t.removeAttr("disabled"),o.isBanned?(un[e]=!0,O(s.bannedPwd)):un[e]=!1},function(){n.removeAttr("disabled"),t.removeAttr("disabled")},e)}function _(n){n.stopPropagation(),pn=a(n.currentTarget),mn=y;var t=a("#"+y,e);
return dn?t.show():t.hide(),!1}function $(n){n.stopPropagation();var t=a(n.currentTarget);t===pn&&(pn=null,mn=""),a("#"+y,e).hide();var o=t.val();return o&&q(o)&&B(o,t),!1}function W(n){n.stopPropagation(),pn=a(n.currentTarget),mn=b;var t=a("#"+b,e);return dn?t.show():t.hide(),!1}function U(n){n.stopPropagation();var t=a(n.currentTarget);return t===pn&&(pn=null,mn=""),a("#"+b,e).hide(),!1}function X(n){if(fn){var t=n.which||n.keyCode;if(dn=d.isCapsLockOn(t,n.shiftKey),mn){var o=a("#"+mn,e);dn?o.show():o.hide()
}}}function Q(n){if(null!==dn&&fn){var t=n.which||n.keyCode;if(t==H&&(dn=!dn,mn)){var o=a("#"+mn,e);dn?o.show():o.hide()}}}function G(e,n,t){var o={};o.cipherValue=bn("","",I,t),o.ski=yn;var r=new p(null,l.bannedPwd,o,e,n);r.start()}function K(e,n){var t=n.actionName;return"action"===t?r(t):en.triggerHandler(v,{"actionName":t,"control":Y}),e&&(e.preventDefault(),e.stopPropagation()),!1}function z(e,n){var t=n.content;a("#"+E,t).on(k+Cn,_),a("#"+E,t).on(N+Cn,$),a("#"+E,t).on(x+Cn,X),a("#"+P,t).on(k+Cn,W),a("#"+P,t).on(N+Cn,U),a("#"+P,t).on(x+Cn,X),a(document).on(T+Cn,Q),en.triggerHandler(g,{"content":t,"control":Y})
}function j(e,n){var t=n.content;a(document).off(Cn),a("#"+E,t).off(Cn),a("#"+P,t).off(Cn),en.triggerHandler(w,{"content":t,"control":Y})}function Z(e,n){var t=n.content;ln=new u.LoadingIndicatorControl(a(".loadingArea",t)),vn=a("#"+on.errorMessageId,t);var o=on.expiryContainerId;hn&&o&&a("#"+o,t).show(),an.passwordError&&(V(an.passwordError),delete an.passwordError),en.triggerHandler(m,{"content":n.content,"control":Y})}function J(e,n){en.triggerHandler(h,{"content":n.content,"control":Y})}var Y=this,en=a(Y),nn=!1,tn=e,on=t,rn=n,an=rn.data,sn=null,cn=null,ln=null,un={},dn=null,fn=$B&&$B.IE&&$B.V<10,pn=null,vn=null,mn="",hn=an.isPasswordExpiryEnabled,gn=!1,wn=D++,Cn=L+wn,yn=SKI,bn=Encrypt;
Y.show=function(){i(),sn&&sn.show()},Y.hide=function(){sn&&sn.hide(),M()},Y.dispose=function(){nn||(en.triggerHandler(C,{"control":Y}),ln&&(ln.dispose(),ln=null),M(),sn&&(sn.dispose(),sn=null,cn=null),vn=null,pn=null,nn=!0),Y=null,en=null,tn=null,on=null,n=null,t=null},o()}var n=window,t=n.wLive,o=t.Core,r=t.Account,a=n.jQuery,i=n.$Config.WLXAccount.strings.resetPassword,s=i.errors,c=$Config.WLXAccount.strings.errors,l=$Config.WLXAccount.urls.dataRequest,u=r.Controls,d=r.FieldHelper,f=r.AnimationHelper,p=o.DataRequest,v="onAction",m="onShow",h="onHide",g="onSetupEvents",w="onRemoveEvents",C="onDispose",y="dCapsLock",b="dReCapsLock",E="iPassword",P="iRetypePassword",A="iExpire",S="1218",k="focus",N="blur",x="keypress",T="keyup",L=".collectnewpasswordcontrol",H=20,R="live.accounts.strings.",I="newpwd",D=0;
e.prototype.events={"action":v,"show":m,"hide":h,"setupEvents":g,"removeEvents":w,"dispose":C},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.CollectNewPasswordControl=e,$Do.register("CollectNewPasswordControl")}(),function(){function e(e,n,t){function o(){X=new l.Controls.PageDialogControl(F,n,t),Q=r(X)}function a(e,n,t){function o(n){var o=e.content();if(V){V.data=V.data||{},V.data.recoveryCode=t,V.data.encryptedRecoveryCode=a,V.data.token=n.token,V.data.isPasswordExpiryEnabled=n.isPasswordExpiryEnabled,V.data.showExpirationCheckbox=n.isPasswordExpiryEnabled;
var r=n.isPasswordConvergence,s=n.isSkypeOnly;q.isSkypeOnly=s,r&&s!==!0&&(V.data.isPasswordConvergence=n.isPasswordConvergence,V.data.microsoftAccountName=n.microsoftAccountName,V.data.skypeName=n.skypeName,i&&(V.data.pageTitle=i.passwordConvergenceTitle,V.data.descriptionText=i.passwordConvergenceDescription,V.data.usernameDesc=i.usernameDescText&&i.usernameDescText.format(n.microsoftAccountName,n.skypeName),V.data.passwordDesc=i.passwordDescText))}E(o),M.triggerHandler(f,{"actionName":"action","control":D})
}function r(n){var t=e.content(),o=m(String(n&&n.error?n.error.code:w));P(t,o),D.setEnabled(!0),V&&V.data&&delete V.data.recoveryCode}var a=Encrypt(null,t,"saproof");D.setEnabled(!1);var l=null;"undefined"!=typeof SKI&&(l=SKI);var d=null;V&&V.data&&(d=V.data.token);var p={"token":d,"publicKey":l,"encryptedCode":a,"recoveryCode":t};u.getTokenType(B)==u.Types.hip&&(p.signinName=q.signinName||null,p.hipSolution=q.hipSolution||null);var v=new c(null,s.dataRequest.verifyRecoveryCode,p,o,r);v.start()}function m(e){if(C[e]){return GetString("live.accounts.strings."+C[e])
}var n=GetString("live.accounts.strings.error_"+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+w)),n}function y(e){return r("#"+_,e)}function b(e){var n=y(e).val();return n?n.trim():n}function E(e){if(W){var n=r("#"+$,e);d.deleteFromListFast(n,function(){W&&n.show()}),W=!1}}function P(e,n){if(n){var t=r("#"+$,e);return t&&(t.text(n),W||(d.addToList(t),W=!0)),!1}return E(e),!0}function A(e,n){var t=l.FieldHelper.verifyRecoveryCode(n,!0);return t?P(e,m(t)):!0}function S(e,n){if("action"===n.actionName){var t=n.control,o=t.content(),r=b(o);
A(o,r)&&a(t,V.NetId,r)}else{M.triggerHandler(f,{"actionName":n.actionName,"control":D})}e.preventDefault(),e.stopPropagation()}function k(e,n){n.on("keypress",function(n){13===n.keyCode&&S(n,{"control":e,"actionName":"action"})})}function N(e){e.off("keypress")}function x(e,n){var t=n.content,o=y(t);U=new l.Field.PlaceholderControl(o)}function T(e,n){U&&(U.dispose(),U=null),M.triggerHandler(h,{"content":n.content,"control":D})}function L(e,n){var t=n.content,o=y(t);setTimeout(function(){o.focus()},0),k(X,o),M.triggerHandler(p,{"content":n.content,"control":D})
}function H(e,n){M.triggerHandler(v,{"content":n.content,"control":D})}function R(){Q&&(Q.on(X.events.action,S),Q.on(X.events.setupEvents,x),Q.on(X.events.removeEvents,T),Q.on(X.events.show,L),Q.on(X.events.hide,H))}function I(){if(Q){var e=y(X.content());N(e),Q.off(X.events.action),Q.off(X.events.setupEvents),Q.off(X.events.removeEvents),Q.off(X.events.show),Q.off(X.events.hide)}}var D=this,M=r(D),O=!1,F=e,V=n,q=V.data||{},B=q.token,_=t.fieldName,$=t.errorMessageId,W=!1,U=(t.errorDetailId,null),X=null,Q=null;
D.show=function(){R(),X&&X.show()},D.hide=function(){X&&X.hide(),I()},D.setEnabled=function(e){X&&X.setEnabled(e)},D.dispose=function(){O||(M.triggerHandler(g,{"control":D}),I(),X&&(X.dispose(),Q=null,X=null)),V=null,_=null,$=null,D=null,M=null,O=!0},o()}var n=window,t=n.wLive,o=t.Core,r=n.jQuery,a=$Config.WLXAccount,i=a.strings,s=a.urls,c=o.DataRequest;registerNamespace("wLive.Account.Controls");var l=t.Account,u=l.TokenHelper,d=l.AnimationHelper,f="onAction",p="onShow",v="onHide",m="onSetupEvents",h="onRemoveEvents",g="onDispose",w="error_500",C={"errorFieldRequired":"AccountRecovery_RecoveryCode_Required","errorInvalidFormat":"error_1215","1300":"error_1215"};
e.prototype.events={"action":f,"show":p,"hide":v,"setupEvents":m,"removeEvents":h,"dispose":g},e.__class=!0,t.Account.Controls.RecoveryEnterRecoveryCodeControl=e}(),function(){function e(e,n,t){function a(){U=new i.Controls.PageDialogControl(V,n,t)}function f(e){if(e&&h[e]){return GetString("live.accounts.strings."+h[e])}var n=GetString("live.accounts.strings.error_"+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+m)),n}function C(e){return r("#"+B,e)}function y(e){var n=C(e).val();
return n?n.trim():n}function b(e){if($){var n=r("#"+_,e);s.deleteFromListFast(n),$=!1}}function E(e,n){if(1==$Config.isINT&&"0"==n){return!0}var t=i.FieldHelper.verifyEmailAddress(n,!0);if(t){var o=f(t);return A(e,o),!1}return!0}function P(e){return"<span class='dirltr_inline'>"+r("<span/>").text(e).html()+"</span>"}function A(e,n){var t=r("#"+_,e);return n?(t&&(t.text(n),$||(s.addToList(t),$=!0)),!1):(b(e),!0)}function S(e,n,t){function r(){b(e),q.data.contactEmail=t,O.triggerHandler(l,{"actionName":"action","control":M})
}function a(n){var t=!0;if(n&&n.error){var o=n.error.code;errorMsg=GetString(w+o);for(var r=g.length,a=0;r>a;a++){if(g[a]==o){t=!1;break}}}var i="";i=f(n&&n.error?n.error.code:m),t?(b(e),O.triggerHandler(l,{"actionName":"action","control":M})):A(e,i),M.setEnabled(!0),X.hideLoading()}var i={"netId":q.NetId,"channel":"email","action":"VerifyNewProof","cxt":"MP","proofId":t,"associationType":"None","token":q.data?q.data.token:null},s=new o.DataRequest(null,$Config.WLXAccount.urls.dataRequest.sendOtt,i,r,a);s.start(),M.setEnabled(!1),X.showLoading()
}function k(e,n){if("action"===n.actionName){var t=n.control,o=t.content(),r=y(o);if(E(o,r)){var a=!1;q&&q.data&&q.data.contactEmail&&q.data.contactEmail_verified&&r==q.data.contactEmail&&(a=!0),a?O.triggerHandler(l,{"actionName":n.actionName,"control":M}):S(o,P(r),r)}}else{O.triggerHandler(l,{"actionName":n.actionName,"control":M})}e.preventDefault(),e.stopPropagation()}function N(e,n){n.on("keypress",function(n){13===n.keyCode&&k(n,{"control":e,"actionName":"action"})})}function x(e){e.off("keypress")}function T(e,n){var t=n.content,o=C(t);
W=new i.Field.PlaceholderControl(o)}function L(e,n){W&&(W.dispose(),W=null),O.triggerHandler(p,{"content":n.content,"control":M})}function H(e,n){var t=n.content,o=C(t);q&&q.data&&q.data.contactEmail&&o.val(q.data.contactEmail),setTimeout(function(){o.focus()},0),N(U,o),X=new c.LoadingIndicatorControl(r(".loadingArea",t)),O.triggerHandler(u,{"content":n.content,"control":M})}function R(e,n){O.triggerHandler(d,{"content":n.content,"control":M})}function I(){U&&(U.$.on(U.events.action,k),U.$.on(U.events.setupEvents,T),U.$.on(U.events.removeEvents,L),U.$.on(U.events.show,H),U.$.on(U.events.hide,R))
}function D(){if(U){var e=C(U.content());x(e),U.$.off(U.events.action),U.$.off(U.events.setupEvents),U.$.off(U.events.removeEvents),U.$.off(U.events.show),U.$.off(U.events.hide)}}var M=this,O=r(M),F=!1,V=e,q=n,B=t.fieldName,_=t.errorMessageId,$=!1,W=null,U=null,X=null;M.show=function(){I(),U&&U.show()},M.hide=function(){U&&U.hide(),D()},M.setEnabled=function(e){U&&U.setEnabled(e)},M.dispose=function(){F||(O.triggerHandler(v,{"control":M}),D(),U&&(U.dispose(),U=null),X&&(X.dispose(),X=null)),q=null,B=null,_=null,M=null,O=null,F=!0
},a()}{var n=window,t=n.wLive,o=t.Core,r=n.jQuery,a=$Config.WLXAccount;a.urls}registerNamespace("wLive.Account.Controls");var i=t.Account,s=i.AnimationHelper,c=t.Account.Controls,l="onAction",u="onShow",d="onHide",f="onSetupEvents",p="onRemoveEvents",v="onDispose",m="error_500",h={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"},g=[1264,1265,1267,1287,500,8e3,8001,8002,6e3,6001,6002],w="live.accounts.strings.error_";e.prototype.events={"action":l,"show":u,"hide":d,"setupEvents":f,"removeEvents":p,"dispose":v},e.__class=!0,c.RecoveryCollectEmailControl=e
}(),function(){function e(e,n,t){function a(){B=new s.Controls.PageDialogControl(M,n,t)}function p(e,n,t){function r(){O&&(O.data=O.data||{},O.data.contactEmail_verified=!0,O.data.contactProof=O.data.contactEmail,O.data.contactProofTypeClass="email"),b(e),I.triggerHandler(u,{"actionName":"action","control":R})}function a(n){var t="";t=C(n&&n.error?n.error.code:h),E(e,t),R.setEnabled(!0)}var s=null;"undefined"!=typeof SKI&&(s=SKI);var c={"action":g,"proofId":O.data.contactEmail,"encryptedCode":t,"publicKey":s};
O&&O.data&&O.data.token&&(c.token=O.data.token);var l=new o.DataRequest(null,i.dataRequest.verifyCode,c,r,a);l.start()}function C(e){if(e&&w[e]){return GetString("live.accounts.strings."+w[e])}var n=GetString("live.accounts.strings.error_"+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+h)),n}function y(e){return r("#iOttText",e)}function b(e){if(q){var n=r("#"+V,e);c.deleteFromListFast(n),q=!1}}function E(e,n){var t=r("#"+V,e);return n?(t&&(t.text(n),q||(c.addToList(t),q=!0)),!1):(b(e),!0)
}function P(e,n){if("action"===n.actionName){var t=n.control,o=t.content(),r=y(o)?y(o).val().trim():null;p(o,O.NetId,Encrypt(null,r,"saproof"))}else{I.triggerHandler(u,{"actionName":n.actionName,"control":R})}e.preventDefault(),e.stopPropagation()}function A(e,n){n.on("keypress",function(n){13===n.keyCode&&P(n,{"control":e,"actionName":"action"})})}function S(e){e.off("keypress")}function k(e,n){var t=n.content,o=r("#iVerifyContactEmailTitle",t);o.text(o.text().format(O.data.contactEmail))}function N(e,n){I.triggerHandler(v,{"content":n.content,"control":R})
}function x(e,n){var t=n.content,o=y(t);setTimeout(function(){o.focus()},10),A(B,o),_=new l.LoadingIndicatorControl(r(".loadingArea",t)),I.triggerHandler(d,{"content":n.content,"control":R})}function T(e,n){I.triggerHandler(f,{"content":n.content,"control":R})}function L(){B&&(B.$.on(B.events.action,P),B.$.on(B.events.setupEvents,k),B.$.on(B.events.removeEvents,N),B.$.on(B.events.show,x),B.$.on(B.events.hide,T))}function H(){B&&(S(y(B.content())),B.$.off(B.events.action),B.$.off(B.events.setupEvents),B.$.off(B.events.removeEvents),B.$.off(B.events.show),B.$.off(B.events.hide))
}var R=this,I=r(R),D=!1,M=e,O=n,F=t.fieldName,V=t.errorMessageId,q=!1,B=null,_=null;R.show=function(){L(),B&&B.show()},R.hide=function(){B&&B.hide(),H()},R.setEnabled=function(e){B&&B.setEnabled(e)},R.dispose=function(){D||(I.triggerHandler(m,{"control":R}),H(),B&&(B.dispose(),B=null),_&&(_.dispose(),_=null)),O=null,F=null,V=null,R=null,I=null,D=!0},a()}var n=window,t=n.wLive,o=t.Core,r=n.jQuery,a=$Config.WLXAccount,i=a.urls;registerNamespace("wLive.Account.Controls");var s=t.Account,c=s.AnimationHelper,l=t.Account.Controls,u="onAction",d="onShow",f="onHide",p="onSetupEvents",v="onRemoveEvents",m="onDispose",h="error_500",g="VerifyOtc",w={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"action":u,"show":d,"hide":f,"setupEvents":p,"removeEvents":v,"dispose":m},e.__class=!0,l.RecoveryVerifyNewProofControl=e}(),function(){function e(e,n,t){function r(){q=new l.Controls.PageDialogControl(D,n,t),B=o(q)}function a(e){function n(n){M&&(O=M.data||{},O.apiSubmitEaRequestSuccess=!0,O.recoveryDate=n.recoveryDate,O.contactEmail=n.contactEmail,O.contactProof=n.contactProof,O.contactProofTypeClass="email",O.token=null,delete O.token),_&&_.hideLoading(),e.setEnabled(!1),R.triggerHandler(d,{"actionName":"action","control":H})
}function t(n){var t="",o=!1;if(O.apiSubmitEaRequestSuccess=!1,_&&_.hideLoading(),n&&n.error){if(n.error.code==C){return O.passwordError=n.error.code,void R.triggerHandler(d,{"actionName":"invalidPassword","control":H})}n.error.code==y&&(o=!0),t=E(String(n.error.code))}if(P(e.content(),t),e.setEnabled(!0),o){var r=e.getButton("cancel");r.addClass("default"),r.show(),setTimeout(function(){r.focus()},0)}else{e.getButton("cancel").show();var a=e.getButton("alternate");a.show(),setTimeout(function(){a.focus()},0)
}}e.getButton("alternate").hide(),e.getButton("cancel").removeClass("default").hide(),P(e.content(),""),e.setEnabled(!1),_&&_.showLoading();var o=null;"undefined"!=typeof SKI&&(o=SKI);var r=[];if(O.verifiedProofs){for(var a=O.verifiedProofs,c=0;c<a.length;c++){r.push(a[c].epid)}}var l={"token":O.token,"contactEmail":O.contactEmail,"contactEpid":O.contactEmailEpid,"encryptedRecoveryCode":O.encryptedRecoveryCode,"publicKey":o,"verifiedProofs":r},u=new s(null,i.dataRequest.eaSubmitRequest,l,n,t);u.start()}function E(e){if(e&&b[e]){return GetString("live.accounts.strings."+b[e])
}var n=GetString(g+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+w)),n}function P(e,n){var t=o("#"+F,e);return n?(t&&(t.text(n),V||(u.addToList(t),V=!0)),!1):(V&&(u.deleteFromListFast(t),V=!1),!0)}function A(e,n){if("alternate"===n.actionName){var t=n.control;P(t.content(),""),a(t)}else{R.triggerHandler(d,{"actionName":n.actionName,"control":H})}e.preventDefault(),e.stopPropagation()}function S(e,n){_=new l.Controls.LoadingIndicatorControl(o(".loadingArea",n.content)),a(n.control),R.triggerHandler(v,{"content":n.content,"control":H})
}function k(e,n){R.triggerHandler(m,{"content":n.content,"control":H})}function N(e,n){R.triggerHandler(f,{"content":n.content,"control":H})}function x(e,n){R.triggerHandler(p,{"content":n.content,"control":H})}function T(){B&&(B.on(q.events.action,A),B.on(q.events.setupEvents,S),B.on(q.events.removeEvents,k),B.on(q.events.show,N),B.on(q.events.hide,x))}function L(){B&&(B.off(q.events.action),B.off(q.events.setupEvents),B.off(q.events.removeEvents),B.off(q.events.show),B.off(q.events.hide))}var H=this,R=o(H),I=!1,D=e,M=n,O=M.data=M.data||{},F=t.errorMessageId,V=!1,q=(t.errorDetailId,null),B=null,_=null;
c++,H.show=function(){T(),q&&q.show()},H.hide=function(){q&&q.hide(),L()},H.setEnabled=function(e){q&&q.setEnabled(e)},H.dispose=function(){I||(R.triggerHandler(h,{"control":H}),L(),q&&(q.dispose(),B=null,q=null),_&&_.dispose(),_=null),M=null,_fieldName=null,F=null,H=null,R=null,I=!0},r()}var n=window,t=n.wLive,o=n.jQuery,r=t.Core,a=$Config.WLXAccount,i=a.urls,s=r.DataRequest,c=0;registerNamespace("wLive.Account.Controls");var l=t.Account,u=l.AnimationHelper,d="onAction",f="onShow",p="onHide",v="onSetupEvents",m="onRemoveEvents",h="onDispose",g="live.accounts.strings.error_",w="error_500",C=1218,y=1078,b={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"action":d,"show":f,"hide":p,"setupEvents":v,"removeEvents":m,"dispose":h},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.EASubmitRequestControl=e}(),function(){function e(e,n,t){function r(){V=new l.Controls.PageDialogControl(I,n,t),q=o(V)}function a(e){function n(n){M&&(M.apiRecoverUserSuccess=!0,M.recoveryCode=n.recoveryCode,M.contactEmail=n.contactEmail,M.contactProof=M.contactEmail,M.contactProofTypeClass="email",M.obfuscatedMembername=n.obfuscatedMembername,M.recoveryCodeCreationtime=n.creationTime,M.enableTfa=n.enableTfa,M.token=null,M.password=null,delete M.token,delete M.password,delete M.passwordExpiryEnabled),B&&B.hideLoading(),e.setEnabled(!1),H.triggerHandler(d,{"actionName":"action","control":L})
}function t(n){var t="";if(M.apiRecoverUserSuccess=!1,B&&B.hideLoading(),n&&n.error){if(n.error.code==C){return M.passwordError=n.error.code,void H.triggerHandler(d,{"actionName":"invalidPassword","control":L})}t=b(String(n.error.code))}E(e.content(),t),e.setEnabled(!0),e.getButton("cancel").show();var o=e.getButton("alternate");o.show(),setTimeout(function(){o.focus()},0)}e.getButton("alternate").hide(),e.getButton("cancel").hide(),E(e.content(),""),e.setEnabled(!1),B&&B.showLoading();var o=null;"undefined"!=typeof SKI&&(o=SKI);
var r={"token":M.token,"contactEmail":M.contactEmail,"contactEpid":M.contactEmailEpid,"password":M.password,"publicKey":o,"emailRecoveryToken":M.emailRecoveryToken,"passwordExpiryEnabled":M.passwordExpiryEnabled},a=new s(null,i.dataRequest.eaRecoverUser,r,n,t);a.start()}function b(e){if(e&&y[e]){return GetString("live.accounts.strings."+y[e])}var n=GetString(g+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+w)),n}function E(e,n){var t=o("#"+O,e);return n?(t&&(t.text(n),F||(u.addToList(t),F=!0)),!1):(F&&(u.deleteFromListFast(t),F=!1),!0)
}function P(e,n){if("alternate"===n.actionName){var t=n.control;E(t.content(),""),a(t)}else{H.triggerHandler(d,{"actionName":n.actionName,"control":L})}e.preventDefault(),e.stopPropagation()}function A(e,n){B=new l.Controls.LoadingIndicatorControl(o(".loadingArea",n.content)),a(n.control),H.triggerHandler(v,{"content":n.content,"control":L})}function S(e,n){H.triggerHandler(m,{"content":n.content,"control":L})}function k(e,n){H.triggerHandler(f,{"content":n.content,"control":L})}function N(e,n){H.triggerHandler(p,{"content":n.content,"control":L})
}function x(){q&&(q.on(V.events.action,P),q.on(V.events.setupEvents,A),q.on(V.events.removeEvents,S),q.on(V.events.show,k),q.on(V.events.hide,N))}function T(){q&&(q.off(V.events.action),q.off(V.events.setupEvents),q.off(V.events.removeEvents),q.off(V.events.show),q.off(V.events.hide))}var L=this,H=o(L),R=!1,I=e,D=n,M=D.data=D.data||{},O=t.errorMessageId,F=!1,V=(t.errorDetailId,null),q=null,B=null;c++,L.show=function(){x(),V&&V.show()},L.hide=function(){V&&V.hide(),T()},L.setEnabled=function(e){V&&V.setEnabled(e)
},L.dispose=function(){R||(H.triggerHandler(h,{"control":L}),T(),V&&(V.dispose(),q=null,V=null),B&&B.dispose(),B=null),D=null,M=null,_fieldName=null,O=null,L=null,H=null,R=!0},r()}var n=window,t=n.wLive,o=n.jQuery,r=t.Core,a=$Config.WLXAccount,i=a.urls,s=r.DataRequest,c=0;registerNamespace("wLive.Account.Controls");var l=t.Account,u=l.AnimationHelper,d="onAction",f="onShow",p="onHide",v="onSetupEvents",m="onRemoveEvents",h="onDispose",g="live.accounts.strings.error_",w="error_500",C=1218,y={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"action":d,"show":f,"hide":p,"setupEvents":v,"removeEvents":m,"dispose":h},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.EARecoverUserControl=e}(),function(){function e(e,S,k){function N(){Zn=new s.PageDialogControl(e,S,k),Jn=Zn.$}function x(e,n){n=n||Tn,e?Yn?(n.parent().find('input[type="text"]').addClass("inputState_error"),n.find("p").text(e),n.show()):(n.parent().find('input[type="email"]').addClass("has-error"),n.text(e),On||(c.addToList(n),On=!0)):T(n)}function T(e){e=e||Tn,Yn?(e.parent().find('input[type="text"]').removeClass("inputState_error"),e.hide()):(e.parent().find('input[type="email"]').removeClass("has-error"),On&&(c.deleteFromListFast(e),On=!1))
}function L(){Fn?D():I()}function H(){var e=o("#"+Qn,Cn);e&&e.val()&&"true"===e.val().toLowerCase()&&(Fn=!0)}function R(){Fn=!Fn,o("#"+Qn,Cn).val(Fn.toString())}function I(){O(),F(),_()}function D(){M(),V(),_()}function M(){o("#PhoneCountrySection",Cn).show(),at&&o("#iSigninNameDiv",Cn).addClass("phoneNumber col-xs-19")}function O(){o("#PhoneCountrySection",Cn).hide(),at&&o("#iSigninNameDiv",Cn).removeClass("phoneNumber col-xs-19")}function F(){o("#iSigninName",Cn).attr("placeholder",_n)}function V(){o("#iSigninName",Cn).attr("placeholder",$n)
}function q(){o("#iExplanationText",Cn).text(Vn)}function B(){o("#iExplanationText",Cn).text(qn)}function _(){var e=o("#"+Xn,Cn);Fn?e.show():e.hide()}function $(){return In=o("#PhoneCountrySection",Cn),In.length>0?(_$phoneCountry=o("#PhoneCountry",In),Q(),_$phoneCountry.val(zn),at&&(Dn=o("#PhoneCountryCode",In),Dn.text("‎+"+tn(Kn.List[zn]))),_$phoneCountry.on("change",G),!0):!1}function W(){et&&(o("#hipTemplateContainer",Cn).addClass("xbox360Hip"),nt?U():X())}function U(){o("#hipTemplateContainer",Cn).hide(),o("#signinNameSection",Cn).show()
}function X(){o("#signinNameSection",Cn).hide(),o("#hipTemplateContainer",Cn).show(),o("#iExplanationText",Cn).text(Bn)}function Q(){var e=zn;if(Kn&&Kn.List){for(var n in Kn.List){var t=a.strEquals(n,e,!0),r=o("<option />");r.text(Kn.List[n]),r.val(n),t&&(r.attr("selected","selected"),jn=tn(Kn.List[n])),r.prop("defaultSelected",t),_$phoneCountry.append(r)}}}function G(){zn=_$phoneCountry.val(),Dn&&Dn.length>0&&Dn.text("‎+"+tn(Kn.List[zn]))}function K(){if(!tt&&(H(),!Fn)){var e=xn.val().trim();if(e){var n=e.match(An),t=e.match(kn),o=J(e);
n||t||!o||j(e)}}return!1}function z(){if(tt){return!0}var e=xn.val().trim();if(!e){return x(h.signinNameMalformed||m.emptyField),!1}var n=e.match(An),t=e.match(kn),o=J(e);if(!n&&!t){if(H(),!Fn){return o?(j(e),!1):(x(h.signinNameMalformed),!1)}if(!o){return x(Wn),Dn&&Dn.length>0&&Dn.addClass("has-error"),setTimeout(function(){xn.focus()},0),!1}}return T(),Dn&&Dn.length>0&&Dn.removeClass("has-error"),!0}function j(e){q(),R(),D(),T(),en(e)}function Z(){B(),R(),L(),T()}function J(e){var n=!1,t=Y(e);return t.match(Sn)&&(n=!0),n
}function Y(e){if(Fn){var n=o("#PhoneCountry",Cn);if(n&&n.val()){var t=Kn.List[n.val()];e=tn(t)+e}}return e}function en(e){var n=tn(e),t=nn(n,jn);null!=t&&xn.val(t)}function nn(e,n){var t=null;return null!=n&&n.trim().length>0&&null!=e&&e.startsWith(n)&&(t=e.replace(new RegExp("^"+n),"")),t}function tn(e){return e.replace(/[^0-9]/g,"")}function on(){z()?document.forms[0].submit():xn.focus()}function rn(){if(ot){var e=n.HIPAMFE;if(e&&e.done){if(e.clientValidation(),e.error){return e.setError(),_viewModel.hip.isValid(!1),Mn&&x(e.getError(),Ln),!1
}_viewModel.hip.isValid(!0)}}return!0}function an(){if(rn()){if(ot){var e=n.HIPAMFE;e&&e.done&&e.verify(function(n,t){o("#WLX_HIP_SOL_AMFE").val(n),o("#WLX_HIP_HIPID_AMFE").val(t),o("#WLX_HIP_HIPTYPE_AMFE").val(e.type);var r=o("#WLX_HIP_FLID_AMFE");r.val()||r.val(i.GetQSValue(f.url,"fid")),sn()},null)}else{sn()}}return!1}function sn(){return document.forms[0].submit()}function cn(){nt?z()&&(nt=!1,X()):(_viewModel.hip.suppressMessages(!1),an())}function ln(){Jn&&(Jn.on(Zn.events.action,dn),Jn.on(Zn.events.setupEvents,fn),Jn.on(Zn.events.removeEvents,pn),Jn.on(Zn.events.show,vn),Jn.on(Zn.events.hide,mn))
}function un(){Jn&&(Jn.off(Zn.events.action),Jn.off(Zn.events.setupEvents),Jn.off(Zn.events.removeEvents),Jn.off(Zn.events.show),Jn.off(Zn.events.hide))}function dn(e,n){var t=n.actionName;return t===A?v?et?cn():(_viewModel.hip.suppressMessages(!1),z()?an():(rn(),xn.focus())):on():gn.triggerHandler(w,{"actionName":t,"control":hn}),e&&(e.preventDefault(),e.stopPropagation()),!1}function fn(e,n){var r=n.content;_viewModel=n.viewModel,tt||(wn=new t.Account.Field.PlaceholderControl(xn),o("#"+Un,Cn).click(function(){return o("#iSigninName",Cn).val(""),Z(),!1
}),o("#iSigninName",Cn).on("change",K)),d.isWin10InclusiveOOBE&&u&&(u.showBackButton(!0),u.handleBackButton(function(){gn&&gn.triggerHandler(w,{"actionName":"cancel","control":hn})})),gn.triggerHandler(b,{"content":r,"control":hn})}function pn(e,n){o("#hipTemplateContainer",n.content).length>0&&o("#hipTemplate").append(o("#hipTemplateContainer").children().detach()),gn.triggerHandler(E,{"content":n.content,"control":hn})}function vn(e,t){var r=t.content;xn=o("#iSigninName",r),Tn=o("#pMemberNameErr",r),Mn&&(Ln=o(Mn,r));
var a=n.HIPAMFE,i="undefined"!=typeof a&&a.done;o("#hipTemplateContainer",t.content).length>0&&i&&(a&&a.updateTitle&&a.updateTitle(),o("#hipTemplateContainer").append(o("#hipTemplate").children().detach())),setTimeout(function(){o(yn.focusElemSelector,r).first().focus()},0),gn.triggerHandler(C,{"content":t.content,"control":hn})}function mn(e,n){gn.triggerHandler(y,{"content":n.content,"control":hn})}var hn=this,gn=o(hn),wn=null,Cn=e,yn=k,bn=S,En=bn.data,Pn=!1,An=p.signinNameRegex,Sn=p.phoneNumberRegex,kn=p.skypeNameRegex,Nn=null,xn=null,Tn=null,Ln=null,Hn=null,Rn=null,In=null,Dn=null,Mn=yn.hipErrorSelector||null,On=p.isErrorMessageDisplayed,Fn=!1,Vn=g.confirmPhoneText,qn=g.pwRHIP_ExplanationText,Bn=g.pwRHIPSection_ExplanationText,_n=g.pWRHIP_EmailOrPhoneExample,$n=g.pWRHIP_PhoneExample,Wn=h.invalidPhoneError,Un="iUsePhoneOrEmailLink",Xn="iUsePhoneOrEmailLinkDiv",Qn="isSigninNamePhone",Gn=null,Kn=k.countries||d.countryList;
Kn&&Kn.Default&&(Gn=Kn.Default.toUpperCase());var zn=Gn,jn=null,Zn=null,Jn=null,Yn=d.isWin10||d.isWin10InclusiveOOBE,et=p.isXbox360,nt=p.isShowUserName,tt=yn.isSigninNameStatic,ot=f.url,rt=!0,at=p.showInlinePhoneCountryCode;hn.loadHip=function(){if(ot){if(o("#hipTemplateContainer").length>0){r.FieldHelper.loadHip(),o("#hipSection").show()}else{if(!l.done){l.postLoad=function(){o(".hipErrorText").removeAttr("aria-live"),l.setError(),Mn&&x(l.getError(),Ln),d.isWin10InclusiveOOBE&&o(".hipErrorImage").hide(),rt||l.setFocus(),rt=!1
},o("#WLX_HIP_FLID_AMFE").val(i.GetQSValue(ot,"fid"));var e=(o("#hipScript script").attr("src",ot),p.hipError);"ServerValidationError"===e&&(l.error=1)}}}},hn.show=function(){ln(),Zn.show(),v&&hn.loadHip(),tt||(H(),L(),$()),d.isWin10InclusiveOOBE&&u&&(u.showBackButton(!d.isLockScreenSscr),u.speakAsync(g.cortana)),W()},hn.hide=function(){Zn&&Zn.hide(),un()},hn.dispose=function(){Pn||(gn.triggerHandler(P,{"control":hn}),wn&&(wn.dispose(),wn=null),un(),Zn&&(Zn.dispose(),Zn=null,Jn=null),Pn=!0),hn=null,Cn=null,yn=null,En=null,bn=null,Hn&&Hn.off(),Rn&&Rn.off(),Nn=xn=Tn=Hn=Rn=null
},N()}var n=window,t=n.wLive,o=n.jQuery,r=t.Account,a=r.FieldHelper,i=r.UrlHelper,s=r.Controls,c=r.AnimationHelper,l=n.HIPAMFE,u=n.MSA&&n.MSA.CXH,d=$Config.WLXAccount,f=d.hip||{},p=d.resetPassword,v=p.showHipChallenge,m=(d.urls.resetPassword,d.strings.errors),h=d.strings.resetPassword.errors,g=d.strings.resetPassword,w="onAction",C="onShow",y="onHide",b="onSetupEvents",E="onRemoveEvents",P="onDispose",A="action";e.prototype.events={"action":w,"show":C,"hide":y,"setupEvents":b,"removeEvents":E,"dispose":P},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.ResetPasswordHipControl=e
}(),function(){function e(){var e=this,t=n.HIPAMFE;e.isCountryCodeDropDownFocused=r.observable(!1),e.dropdownCaretImg=s.getDropDownCaretImage(),t&&t.observable?mix(e,t.observable):(e.hip=r.observable(""),e.hip.isValid=r.observable(!0),e.hip.suppressMessages=r.observable(!0),e.hip.focused=r.observable(!1),e.hip.focused.extend({"notify":"always"}),i.hipError&&(e.hip.serverError=i.hipError))}var n=window,t=n.wLive,o=t.Account,r=n.ko,a=$Config.WLXAccount,i=a.resetPassword,s=o&&o.Util&&o.Util.ConvergedUxUtil;e.__class=!0,registerNamespace("wLive.Account.ViewModels"),t.Account.ViewModels.ResetPasswordHipViewModel=e
}(),function(){function e(){function e(){{var e=s.viewContext||{};e.data=e.data||{}}t(),v=new a.FlowController(o("#pageControlHost"),e,s.options),v.setStateChangeFunc(n),v.show(s.startState)}function n(e,n){if(i){try{switch(n){case u:return i.finish(FinishStates.Success),null;case d:return i.finish(FinishStates.Cancel),null;case f:return i.finish(FinishStates.Error),null}}catch(t){return null}}return n}function t(){var e=o("#recoveryTemplates");r(c,e),r(l,e)}function r(e,n){var t=s.options.viewDefs[e];if(t){var r=t.sectionId,a=null;
r&&(m[r]?a=m[r].clone():(a=o("#"+r,n),a.detach(),m[r]=a)),t.options.sectionId||(t.options.sectionId=r),t.options.viewTemplate=a;var i={"action":r+"Action"};t.hasCancel&&(i.cancel=r+"Cancel"),t.hasAlternate&&(i.alternate=r+"Alternate"),t.options.buttons=i}}var p=this,v=null,m={};p.dispose=function(){v&&(v.dispose(),v=null)},e()}var n=window,t=n.wLive,o=n.jQuery,r=t.Account,a=r.Controls,i=n.MSA&&n.MSA.CXH,s=n.$Config.WLXAccount.resetPassword,c="why",l="hip",u="cxhSuccess",d="cxhCancel",f="cxhError";registerNamespace("wLive.Account.Page"),t.Account.Page.ResetPasswordSignInName=e,$Do.register("ResetPasswordSignInName")
}(),function(){function e(){function e(e,n){var t=(n.control,n.container),o=n.viewContext;if(n.activeState==H){r("#PrintRecoveryCode",t).on("click",o,_)}else{if(n.activeState==E){if((o.data.apiResetPasswordSuccess||!o.data.contactEmail)&&r("#iResetSuccessEmail",t).hide(),o.data.recoveryCode||r("#iResetSuccessRecoveryCode",t).hide(),!o.data.enableTfa){r("#iResetSuccessFinal",t).hide();var a=r("#iResetSuccessAlternate",t),i=r("#iResetSuccessAction",t).parent();a.hide(),a.parent().hide(),i.addClass("col-xs-24"),i.removeClass("col-xs-12")
}l&&l.setWizardButtons(!1,!0,!1)}}}function t(e,n,t){if("cancel"===t||t===R){return c.getTokenType(n.data.token)==c.Types.reset?e[1]:e[0]}var o=c.getTokenType(n.data.token),r=n.data||{};if(o==c.Types.recover){var a=!1;return a||r.contactEmail?!Q&&r.isPasswordConvergence&&r.isSkypeOnly!==!0?e[3]:e[2]:e[1]}return e[0]}function o(e,n){var t=n.data||{};return c.getTokenType(n.data.token)==c.Types.recover?!Q&&t.isPasswordConvergence&&t.isSkypeOnly!==!0?e[2]:e[1]:e[0]}function F(e){if(e&&e.data){var n=e.data;if(n.contactEmailEpid=null,n.verifiedProofs){for(var t=n.verifiedProofs,o=0;o<t.length;o++){var r=t[o];
if(r.used&&r.channel&&"email"==r.channel.toLowerCase()){n.contactEmailEpid=r.epid,n.contactEmail||(n.contactEmail=r.name,n.contactProof=r.name,n.contactProofTypeClass="email");break}}}}}function V(e,n,a,i){try{switch(n){case D:return u.finish(d.Success),null;case M:return u.finish(d.Cancel),null;case O:return u.finish(d.Error),null}}catch(s){return null}(e===h||e===w)&&F(a);var l=a.data||{},f=l.isPasswordConvergence;if(r.isArray(n)){if(i===R&&(e===v||e===m)){return t(n,a,i)}if(e===v){return a.data.selectedActionType===G.SQSA?n[1]:n[0]
}if(e===h||e===w){var p=c.getTokenType(l.token);return p===c.Types.authz?!Q&&f&&l.isSkypeOnly!==!0?n[2]:n[0]:p===c.Types.reset?n[1]:null}return e===A?t(n,a,i):e===S?a.data.contactEmail||a.data.contactEmailEpid?n[1]:n[0]:e===N?o(n,a,i):e===E?l.enableTfa?n[1]:n[0]:e===C&&!Q&&f&&l.isSkypeOnly!==!0?n[1]:n[0]}return n}function q(){var t=i.viewContext||{},o=t.data=t.data||{};o.rawProofList&&(o.proofList=r.parseJSON(o.rawProofList)),B(),U=new s.FlowController(r("#pageControlHost"),t,i.options),U.setStateChangeFunc(V),U.$.on(U.events.stateChanged,e),U.show(i.startState);
var c=n.MSA&&n.MSA.CXH;a.isWin10InclusiveOOBE&&c&&c.showBackButton(!a.isLockScreenSscr)}function B(){var e=r("#recoveryTemplates");$(f,e),$(p,e),$(v,e),$(h,e),$(g,e),$(m,e),$(w,e),$(C,e),$(y,e),$(P,e),$(b,e),$(E,e),$(A,e),$(S,e),$(k,e),$(N,e),$(x,e),$(T,e),$(L,e),$(H,e),$(I,e),X={}}function _(e){e.preventDefault(),e.stopPropagation();var n=e.data,t=a.strings.recoveryCode,o={"dir":t.printRcTextDir||"","title":t.printRcTitle||"","desc1":t.printRcDesc1||"","desc2":t.printRcDesc2||"","rcHeader":t.printRcHeader||"","rcValue":n.data.recoveryCode||"","ctHeader":t.printRcCtHeader||"","ctValue":n.data.recoveryCodeCreationtime||"","mnHeader":t.printRcMnHeader||"","mnValue":n.data.obfuscatedMembername||""};
PrintRecoveryCode(o)}function $(e,n){var t=i.options.viewDefs[e];if(t){var o=t.sectionId,a=null;o&&(X[o]?a=X[o].clone():(a=r("#"+o,n),a.detach(),X[o]=a)),t.options.sectionId||(t.options.sectionId=o),t.options.viewTemplate=a;var s={"action":o+"Action"};t.hasCancel&&(s.cancel=o+"Cancel"),t.hasAlternate&&(s.alternate=o+"Alternate"),t.hasRevert&&(s.revert=o+"Revert"),t.options.buttons=s}}var W=this,U=null,X={},Q=i.skipGoodNews,G={"SQSA":"SQSA"};W.dispose=function(){U&&U.dispose()},q()}var n=window,t=n.wLive,o=t.Account,r=n.jQuery,a=$Config.WLXAccount,i=a.resetPassword,s=o.Controls,c=o.TokenHelper,l=null,u=n.MSA&&n.MSA.CXH,d=u&&u.FinishStates,f="goodNews",p="recoveryGoodNews",v="proofs",m="proofsTfa",h="code",g="sqsa",w="codeTfa",C="validateAccount",y="newPwd",b="fedWeakCredReview",E="success",P="collectNewPwd",A="enterRC",S="waitFlow",k="collectEmail",N="verifyContactEmail",x="startWait",T="eaRecoverUser",L="eaSubmitRequest",H="recoveryCode",R="markLost",I="error",D="cxhSuccess",M="cxhCancel",O="cxhError";
$Do.when("ExternalHelper",0,function(){l=n.ExternalHelper}),registerNamespace("wLive.Account.Page"),t.Account.Page.ResetPassword=e,$Do.register("ResetPassword")}(),function(){function e(e,n){if(e){if("undefined"!=typeof n&&n[e]){return GetString("live.accounts.strings."+n[e])}if(S[e]){return GetString("live.accounts.strings."+S[e])}}var t=GetString("live.accounts.strings.error_"+e);return t||(t=GetString("live.accounts.strings."+e)),t||(t=GetString("live.accounts.strings."+y)),t}function n(e){return"string"==typeof e
}function t(e,t,o){return n(e)&&n(t)?o?e.toLowerCase()===t.toLowerCase():e===t:!1}function o(e,n){if(e=(e||"").trim(),n&&""===e){return b}if(e.length>113){return P}var t=new RegExp(h.AltEmailRegEx);return e.match(t)?null:P}function r(e,n){var t=e>=97&&122>=e,o=e>=65&&90>=e;return t&&n||o&&!n}function a(e,n,t){return e=(e||"").trim(),n&&""===e?b:e.length>(t?t:10)?E:null}function i(e,n){return e=(e||"").trim(),n&&""===e?b:e.length>30||e.length<1?E:null}function s(e,n){n&&(e?n.css("opacity",1):n.css("opacity",0))
}function c(e,n){if(e){if(e.indexOf("@")>=0){var t=e.split("@");if(2===t.length){for(var o=t[1].toLowerCase(),r=0,a=n.length;a>r;r++){if(n[r].toLowerCase()===o){return A.Live}}return A.EASI}return A.Unknown}return A.Phone}return A.Unknown}function l(e,n){var t=!1;if(e&&n&&e.indexOf("@")>=0){var o=e.split("@");if(2===o.length){var r=o[1].toLowerCase();n.toLowerCase()===r&&(t=!0)}}return t}function u(e,n){if(e){var t=new RegExp(h.PhoneNumberFormat);if(!e.match(t)){return E}}else{if(n){return b}}return null}function d(){if(g&&g.url&&("undefined"==typeof f.HIPAMFE&&(HIPAMFE={"holder":"hipContent","scriptHolder":"hipScript","done":!1,"showMenu":!0,"showAddAccountOption":!1,"inputWidth":$B.IE&&$B.major<9?200:"100%","cssSet":{"cssCdHIPInput":"form-control input-max-width","cssCdHIPList":"form-control","cssCdHIPError":"alert alert-error","cssCdHIPErrorImg":"hide","cssCdHIPButton":"btn btn-default","cssCdHIPLabel":"text-base"},"createObservable":function(){var e=f.HIPAMFE;
return e.observable={},p.extend(e.observable,m.viewModelHandle),e.observable.hip.suppressMessages(!0),e.observable.hip(""),e.observable},"updateTitle":function(){var e=f.HIPAMFE,n=p("#HipPane");e.type&&("sms"===e.type?(p(".forVisualHip",n).addClass("hide"),p(".forSmsHip",n).removeClass("hide")):(p(".forVisualHip",n).removeClass("hide"),p(".forSmsHip",n).addClass("hide")))},"postLoad":function(){function e(e){return p("label",e).addClass("text-base text-body"),h.isWin10?(p("select",e).addClass("win-dropdown").parent().addClass("template-input inputType_large"),p("input[type=text]",e).addClass("win-textbox").parent().addClass("template-input inputType_large")):h.isWin10InclusiveOOBE?(p("select",e).removeClass().addClass("win-dropdown").parent().addClass("template-input"),p("input[type=text]",e).removeClass().addClass("win-textbox").parent().addClass("template-input")):(p("select",e).addClass("input-max-width").parent().addClass(n).removeAttr("style"),p("input[type=text]",e).removeClass("hiddenHipInputText").addClass("input-max-width").parent().addClass(n).removeAttr("style")),"#hipContent #wlspispHipControlButtonsContainer"===e.selector&&(p("body").hasClass("cb")?p("a",e).addClass("btn btn-block").parent().addClass(n).removeAttr("style"):p("a",e).addClass("btn btn-primary btn-block").parent().addClass(n).removeAttr("style")),e
}var n="form-group col-xs-24 template-input",t="col-xs-12",o=!1;p(".col-md-24").length>0?(n="form-group col-md-24 template-input",t="col-md-12",o=!1):p(".col-xs-18").length>0&&(n="form-group col-xs-18 template-input",t="col-xs-9",o=!0);var r=f.HIPAMFE,a=p("#hipDesc"),i=p("#hipTemplateContainer"),s=(p("#HipPane"),p("#"+r.holder));if(a.length>0&&a.addClass("text-body"),("undefined"===w||0===w)&&i.addClass("text-body"),C&&C.hideContentProgress(),r.updateTitle(),ko.cleanNode(i[0]),"sms"===r.type){var c=p("#pageControlHost input[type=submit]:visible");
m.ftrViewModelHandle?m.ftrViewModelHandle.buttons.nextButton.disabled(!0):c.length>0&&c.attr("disabled","disabled"),o&&p("#hipSection div.col-xs-18").addClass("alert alert-error");var l=e(p("#wlspispHIPErrorContainer",s).removeAttr("style").addClass(n)).detach().attr("data-bind","visible: !hip.suppressMessages() && !hip.isValid()"),u=e(p("#wlspispHipChallengeContainer",s).removeAttr("style")).detach(),d=e(p("#wlspispHipControlButtonsContainer",s).removeAttr("style")).detach().on("click",function(){r&&r.observable&&r.observable.hip.suppressMessages(!0)
}),v=e(p("#wlspispHipSolutionContainer",s)).hide().detach();p(".form-control",v).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }"),i.html("").append(u).append(d).append(v).append(l),r.createObservable(),r.observable.hip.suppressMessages(!0),ko.applyBindings(r.observable,i[0]);try{var g=m.viewModelHandle;g.phoneNumber&&g.phoneCountry&&r.setPhoneNumber(g.phoneCountry(),g.phoneNumber())}catch(y){}var b=r.getHipDataResponse;r.getHipDataResponse=function(e){b(e),e||(m.ftrViewModelHandle?m.ftrViewModelHandle.buttons.nextButton.disabled(!1):c.length>0&&c.removeAttr("disabled"))
},p('[id^="wlspispHIPPhoneInput"]',u).first().focus()}else{var d=p("<div></div>").addClass("text-body btn-group").addClass(t).append(p("a",s).addClass("btn btn-block captchaHIPLinks").attr("role","button").removeAttr("style").detach()),u=p("<div></div>").addClass(t);if(r.type===k){u.append(p(".cssWLSPHIPAudio",d).parent().detach().removeClass("btn btn-block"))}else{var E=p("img",s).filter(function(){return this.src.indexOf("GetHIPData")>-1}).css("height","auto").css("width","100%").css("max-width","200px");o||E.addClass("text-body"),u.append(E.detach())
}var v=p("<div></div>").addClass("form-group template-input").addClass(n),P=p(".form-control",s);P.attr("name",P.attr("id")),r.type!==k&&0!==$Config.isPlaceholderSupported&&p("body").hasClass("cb")?v.append(P.removeAttr("style").attr("placeholder",HIPAMFE.getInstruction()).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()):(v.append(p("<label></label>").addClass("text-base").text(HIPAMFE.getInstruction())),v.append(P.removeAttr("style").attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()),r.type===k&&setTimeout(function(){P.focus()
},0));var l=p("<div></div>").addClass(n).append(p(".alert-error",s).detach().addClass("floatLeft"));i.html("").append(u).append(d).append(v).append(l),r.createObservable(),ko.applyBindingsWithValidation(r.observable,i[0])}r.observable.hip.serverError&&(r.error=1,r.setError(),r.observable.hip.serverError=null,p.each(p(".alert-error",i),function(e,n){var t=p(n);return"inline"===t.css("display")?(t.css("display","block"),!1):void 0}))}}),f.HIPAMFE&&!f.HIPAMFE.done)){C&&C.showContentProgress();var e=p("#hipScript")[0],n=p("#hipScript script")[0];
if(n){n.src=g.url}else{var t=document.createElement("script");t.type="text/javascript",t.src=g.url,e.appendChild(t)}}}var f=window,p=f.jQuery,v=f.wLive,m=v.Account,h=(v.Core.DataRequest,f.$Config.WLXAccount),g=h.hip,w=h.isConvergedUX,C=m.Util&&m.Util.MarchingAnts,y="error_500",b="errorFieldRequired",E="errorInvalidFormat",P="errorEmailInvalidFormat",A={"EASI":"EASI","Live":"Live","Phone":"Phone","Unknown":"Unknown"},S={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"},k="audio";
registerNamespace("wLive.Account.FieldHelper"),v.Account.FieldHelper.verifyEmailAddress=o,v.Account.FieldHelper.verifyOttCode=a,v.Account.FieldHelper.verifyRecoveryCode=i,v.Account.FieldHelper.strEquals=t,v.Account.FieldHelper.isCapsLockOn=r,v.Account.FieldHelper.toggleInlineLabel=s,v.Account.FieldHelper.getMemberNameType=c,v.Account.FieldHelper.doesDomainMatch=l,v.Account.FieldHelper.verifyPhoneNumber=u,v.Account.FieldHelper.getErrorString=e,v.Account.FieldHelper.loadHip=d,v.Account.FieldHelper.memberNameTypes=A,v.Account.FieldHelper.errors={"required":b,"invalidFormat":E,"emailInvalidFormat":P}
}();